(function(e){function t(t){for(var n,a,r=t[0],s=t[1],i=t[2],d=0,u=[];d<r.length;d++)a=r[d],Object.prototype.hasOwnProperty.call(c,a)&&c[a]&&u.push(c[a][0]),c[a]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);b&&b(t);while(u.length)u.shift()();return l.push.apply(l,i||[]),o()}function o(){for(var e,t=0;t<l.length;t++){for(var o=l[t],n=!0,a=1;a<o.length;a++){var s=o[a];0!==c[s]&&(n=!1)}n&&(l.splice(t--,1),e=r(r.s=o[0]))}return e}var n={},c={app:0},l=[];function a(e){return r.p+"js/"+({}[e]||e)+"."+{"chunk-2d0d6e77":"e4320951"}[e]+".js"}function r(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.e=function(e){var t=[],o=c[e];if(0!==o)if(o)t.push(o[2]);else{var n=new Promise((function(t,n){o=c[e]=[t,n]}));t.push(o[2]=n);var l,s=document.createElement("script");s.charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.src=a(e);var i=new Error;l=function(t){s.onerror=s.onload=null,clearTimeout(d);var o=c[e];if(0!==o){if(o){var n=t&&("load"===t.type?"missing":t.type),l=t&&t.target&&t.target.src;i.message="Loading chunk "+e+" failed.\n("+n+": "+l+")",i.name="ChunkLoadError",i.type=n,i.request=l,o[1](i)}c[e]=void 0}};var d=setTimeout((function(){l({type:"timeout",target:s})}),12e4);s.onerror=s.onload=l,document.head.appendChild(s)}return Promise.all(t)},r.m=e,r.c=n,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/API_Testing/my-vue-app/",r.oe=function(e){throw console.error(e),e};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],i=s.push.bind(s);s.push=t,s=s.slice();for(var d=0;d<s.length;d++)t(s[d]);var b=i;l.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"0c21":function(e,t,o){},1409:function(e,t,o){"use strict";o("c2c6")},"14ef":function(e,t,o){"use strict";o("3150")},"17af":function(e,t,o){"use strict";o("1eaa")},"1eaa":function(e,t,o){},"284b":function(e,t,o){},"2c5c":function(e,t,o){},3150:function(e,t,o){},"31d1":function(e,t,o){"use strict";o("3641")},3641:function(e,t,o){},"3af8":function(e,t,o){"use strict";o("65d8")},"48ef":function(e,t,o){"use strict";o("7b78")},"4ff5":function(e,t,o){},"53d4":function(e,t,o){"use strict";o("2c5c")},"563b":function(e,t,o){"use strict";o("8ec4")},"56d7":function(e,t,o){"use strict";o.r(t);var n=o("7a23");const c={id:"app"};function l(e,t,o,l,a,r){const s=Object(n["resolveComponent"])("router-view");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",c,[Object(n["createVNode"])(s)])}var a={name:"App",name:"App",mounted(){document.title="Print-A-Test"}},r=(o("c4f7"),o("6b0d")),s=o.n(r);const i=s()(a,[["render",l]]);var d=i,b=o("6605");const u={class:"theme-welcome"},m={class:"button-container"},p={class:"button-container"},O={class:"button-container"};function h(e,t,o,c,l,a){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",u,[t[3]||(t[3]=Object(n["createElementVNode"])("div",{class:"top-banner"},[Object(n["createElementVNode"])("div",{class:"banner-title"},"Welcome to Print-A-Test")],-1)),t[4]||(t[4]=Object(n["createElementVNode"])("div",{class:"center large-paragraph",style:{color:"#222"}}," Select the role you are logging in as:",-1)),Object(n["createElementVNode"])("div",m,[Object(n["createVNode"])(r,{to:"/TeacherLog"},{default:Object(n["withCtx"])(()=>t[0]||(t[0]=[Object(n["createElementVNode"])("button",{class:"button"},"Teacher",-1)])),_:1})]),t[5]||(t[5]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("div",p,[Object(n["createVNode"])(r,{to:"/PubLog"},{default:Object(n["withCtx"])(()=>t[1]||(t[1]=[Object(n["createElementVNode"])("button",{class:"button"},"Publisher",-1)])),_:1})]),t[6]||(t[6]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("div",O,[Object(n["createVNode"])(r,{to:"/WebmasterLog"},{default:Object(n["withCtx"])(()=>t[2]||(t[2]=[Object(n["createElementVNode"])("button",{class:"button"},"Webmaster",-1)])),_:1})])])}var j={name:"Welcome"};o("53d4");const k=s()(j,[["render",h],["__scopeId","data-v-437ab624"]]);var N=k;const g={class:"theme-publisher"},E={class:"top-banner"},V={class:"banner-actions"},y={class:"center large-paragraph",style:{color:"#222"}},w={class:"page-wrapper"},f={class:"button-row"},T={key:0,class:"p_dropdown"},v={class:"p_dropdown-content"},B={key:1};function _(e,t,o,c,l,a){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",g,[Object(n["createElementVNode"])("div",E,[t[1]||(t[1]=Object(n["createElementVNode"])("div",{class:"banner-title"},"Textbook Selection",-1)),Object(n["createElementVNode"])("div",V,[Object(n["createVNode"])(r,{to:"/",class:"p_banner-btn"},{default:Object(n["withCtx"])(()=>t[0]||(t[0]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",y,[Object(n["createElementVNode"])("div",w,[t[5]||(t[5]=Object(n["createTextVNode"])(" Please select or add a textbook: ")),Object(n["createElementVNode"])("div",f,[l.textbooks.length?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",T,[t[2]||(t[2]=Object(n["createElementVNode"])("button",{class:"p_dropbtn"},"Select Textbook",-1)),Object(n["createElementVNode"])("div",v,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.textbooks,e=>(Object(n["openBlock"])(),Object(n["createBlock"])(r,{key:e.id,to:{path:"PubQuestions",query:{title:e.title,textbook_id:e.id}}},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.title),1)]),_:2},1032,["to"]))),128))])])):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",B," No courses available. ")),Object(n["createVNode"])(r,{to:"PubNewBook"},{default:Object(n["withCtx"])(()=>t[3]||(t[3]=[Object(n["createElementVNode"])("button",{class:"p_button"},"Add New Textbook",-1)])),_:1}),t[4]||(t[4]=Object(n["createElementVNode"])("br",null,null,-1))])])])])}var x=o("cee4");const C=x["a"].create({baseURL:"https://api-testing-goob.onrender.com",responseType:"json"});async function S(){const e=localStorage.getItem("token");if(!e)return null;try{const t=await x["a"].post("https://api-testing-goob.onrender.com/auth/refresh",{token:e}),o=t.data.token;return localStorage.setItem("token",o),o}catch(t){return console.error("Token refresh failed:",t),localStorage.removeItem("token"),localStorage.removeItem("user_id"),localStorage.removeItem("role"),null}}C.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer "+t),e},e=>Promise.reject(e)),C.interceptors.response.use(e=>e,async e=>{const t=e.config;if(e.response&&401===e.response.status&&!t._retry){t._retry=!0;const e=await S();if(e)return t.headers.Authorization="Bearer "+e,C(t);console.warn("Token refresh failed or user logged out.")}return Promise.reject(e)});var F=C,D=o("f761"),I={name:"PublisherHome",data(){return{textbooks:[],error:null}},created(){this.fetchTextbooks()},methods:{async fetchTextbooks(){try{console.log("Fetching textbooks...");const e=await F.get("/textbooks",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log("Textbooks fetched:",e.data),e.data&&e.data.textbooks?this.textbooks=e.data.textbooks:this.error="Failed to fetch textbooks data."}catch(e){console.error("Error fetching textbooks:",e),e.response?this.error=`Error: ${e.response.status} - ${e.response.data.message||e.response.statusText}`:this.error="Network error or server is not responding."}}}};o("6a83");const q=s()(I,[["render",_],["__scopeId","data-v-46fbfbd4"]]);var A=q;const M={class:"theme-publisher"},Q={class:"center large-paragraph",style:{color:"#222"}},P=["disabled"],U={key:0,class:"error-message"},L={key:1,class:"loading-message"};function $(e,t,o,c,l,a){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",M,[t[14]||(t[14]=Object(n["createElementVNode"])("div",{class:"top-banner"},[Object(n["createElementVNode"])("div",{class:"banner-title"},"Publisher Login")],-1)),Object(n["createElementVNode"])("div",Q,[t[11]||(t[11]=Object(n["createTextVNode"])(" Please enter your publisher username and password: ")),t[12]||(t[12]=Object(n["createElementVNode"])("br",null,null,-1)),t[13]||(t[13]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("form",{onSubmit:t[2]||(t[2]=Object(n["withModifiers"])((...e)=>a.submitForm&&a.submitForm(...e),["prevent"]))},[t[3]||(t[3]=Object(n["createElementVNode"])("label",{for:"uname"},"Username:",-1)),t[4]||(t[4]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"uname","onUpdate:modelValue":t[0]||(t[0]=e=>l.username=e)},null,512),[[n["vModelText"],l.username]]),t[5]||(t[5]=Object(n["createElementVNode"])("br",null,null,-1)),t[6]||(t[6]=Object(n["createElementVNode"])("br",null,null,-1)),t[7]||(t[7]=Object(n["createElementVNode"])("label",{for:"pass"},"Password:",-1)),t[8]||(t[8]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"password",id:"pass","onUpdate:modelValue":t[1]||(t[1]=e=>l.password=e)},null,512),[[n["vModelText"],l.password]]),t[9]||(t[9]=Object(n["createElementVNode"])("br",null,null,-1)),t[10]||(t[10]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("input",{type:"submit",value:"Submit",disabled:l.loading},null,8,P)],32),l.errorMessage?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",U,Object(n["toDisplayString"])(l.errorMessage),1)):Object(n["createCommentVNode"])("",!0),l.loading?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",L,"Logging in...")):Object(n["createCommentVNode"])("",!0)])])}var z={data(){return{username:"",password:"",errorMessage:"",loading:!1}},mounted(){const e=localStorage.getItem("token");if(e)try{const t=Object(D["default"])(e),o=Date.now()/1e3;t.exp>o&&"publisher"===t.role&&this.$router.push("/PubHome")}catch(t){console.error("Invalid token",t)}},methods:{async submitForm(){if(this.username&&this.password)if(this.username.trim().length<3||this.password.trim().length<6)this.errorMessage="Username must be at least 3 characters and password at least 6 characters.";else{this.loading=!0,this.errorMessage="";try{const e=await F.post("/auth/login",{username:this.username.toLowerCase(),password:this.password}),{token:t,user_id:o,role:n}=e.data;localStorage.setItem("token",t),localStorage.setItem("user_id",o),localStorage.setItem("role",n),"publisher"===n?this.$router.push("/PubHome"):(this.errorMessage="Only publishers can log in here.",localStorage.clear())}catch(e){e.response?401===e.response.status?this.errorMessage="Invalid username or password.":this.errorMessage=e.response&&e.response.data&&e.response.data.message||"An error occurred during login.":this.errorMessage="Network error. Please check your connection."}finally{this.loading=!1}}else this.errorMessage="Please enter both username and password."}}};o("17af");const H=s()(z,[["render",$],["__scopeId","data-v-800dd872"]]);var R=H;const W={class:"theme-publisher"},G={class:"top-banner"},J={class:"banner-actions"},X={class:"center large-paragraph",style:{color:"#222"}};function K(e,t,o,c,l,a){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",W,[Object(n["createElementVNode"])("div",G,[t[8]||(t[8]=Object(n["createElementVNode"])("div",{class:"banner-title"},"Add New Textbook",-1)),Object(n["createElementVNode"])("div",J,[Object(n["createVNode"])(r,{to:"/PubHome",class:"p_banner-btn"},{default:Object(n["withCtx"])(()=>t[6]||(t[6]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"p_banner-btn"},{default:Object(n["withCtx"])(()=>t[7]||(t[7]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",X,[Object(n["createElementVNode"])("form",{onSubmit:t[5]||(t[5]=Object(n["withModifiers"])((...e)=>a.saveBook&&a.saveBook(...e),["prevent"]))},[t[9]||(t[9]=Object(n["createElementVNode"])("label",{for:"textbookTitle"},"Textbook Title:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"textbookTitle","onUpdate:modelValue":t[0]||(t[0]=e=>l.textbookTitle=e),style:{height:"20px"}},null,512),[[n["vModelText"],l.textbookTitle]]),t[10]||(t[10]=Object(n["createElementVNode"])("br",null,null,-1)),t[11]||(t[11]=Object(n["createElementVNode"])("label",{for:"author"},"Author:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"author","onUpdate:modelValue":t[1]||(t[1]=e=>l.author=e),style:{height:"20px"}},null,512),[[n["vModelText"],l.author]]),t[12]||(t[12]=Object(n["createElementVNode"])("br",null,null,-1)),t[13]||(t[13]=Object(n["createElementVNode"])("label",{for:"ISBN"},"ISBN:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"ISBN","onUpdate:modelValue":t[2]||(t[2]=e=>l.ISBN=e),style:{height:"20px"}},null,512),[[n["vModelText"],l.ISBN]]),t[14]||(t[14]=Object(n["createElementVNode"])("br",null,null,-1)),t[15]||(t[15]=Object(n["createElementVNode"])("label",{for:"version"},"Version:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"version","onUpdate:modelValue":t[3]||(t[3]=e=>l.version=e),style:{height:"20px"}},null,512),[[n["vModelText"],l.version]]),t[16]||(t[16]=Object(n["createElementVNode"])("br",null,null,-1)),t[17]||(t[17]=Object(n["createElementVNode"])("label",{for:"websiteLink"},"Website Link:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"websiteLink","onUpdate:modelValue":t[4]||(t[4]=e=>l.websiteLink=e),style:{height:"20px"}},null,512),[[n["vModelText"],l.websiteLink]]),t[18]||(t[18]=Object(n["createElementVNode"])("br",null,null,-1)),t[19]||(t[19]=Object(n["createElementVNode"])("div",{class:"center large-heading"},[Object(n["createElementVNode"])("input",{type:"submit",value:"Save"})],-1))],32)])])}var Y={name:"PublisherNewBook",data(){return{textbookTitle:"",author:"",ISBN:"",version:"",websiteLink:""}},methods:{async saveBook(){if(this.textbookTitle&&this.author&&this.ISBN&&this.version){const t={textbook_title:this.textbookTitle,textbook_author:this.author,textbook_isbn:this.ISBN,textbook_version:this.version,websiteLink:this.websiteLink};try{const e=await F.post("/textbooks",t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log("Book saved successfully:",e.data),alert("Book saved successfully!"),this.$router.push({path:"/PubQuestions"})}catch(e){console.error("Error saving book:",e),alert("Failed to save the book. Please try again.")}}else alert("Please fill out all fields.")}}};o("5c71");const Z=s()(Y,[["render",K],["__scopeId","data-v-1ac84e00"]]);var ee=Z;const te={class:"theme-publisher"},oe={class:"top-banner"},ne={class:"banner-actions"},ce={class:"center large-paragraph",style:{color:"#222"}},le={key:0,style:{color:"red","margin-top":"10px"}};function ae(e,t,o,c,l,a){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",te,[Object(n["createElementVNode"])("div",oe,[t[6]||(t[6]=Object(n["createElementVNode"])("div",{class:"banner-title"},"Create New Test Bank",-1)),Object(n["createElementVNode"])("div",ne,[Object(n["createVNode"])(r,{to:"/PubHome",class:"p_banner-btn"},{default:Object(n["withCtx"])(()=>t[4]||(t[4]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"p_banner-btn"},{default:Object(n["withCtx"])(()=>t[5]||(t[5]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",ce,[Object(n["createElementVNode"])("form",{onSubmit:t[3]||(t[3]=Object(n["withModifiers"])((...e)=>a.saveTestBank&&a.saveTestBank(...e),["prevent"]))},[t[7]||(t[7]=Object(n["createElementVNode"])("label",{for:"bankName"},"Name of Test Bank:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"bankName","onUpdate:modelValue":t[0]||(t[0]=e=>l.bankName=e),style:{height:"20px"},required:""},null,512),[[n["vModelText"],l.bankName]]),t[8]||(t[8]=Object(n["createElementVNode"])("br",null,null,-1)),t[9]||(t[9]=Object(n["createElementVNode"])("label",{for:"bankCh"},"Textbook Chapter:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"bankCh","onUpdate:modelValue":t[1]||(t[1]=e=>l.bankChapter=e)},null,512),[[n["vModelText"],l.bankChapter]]),t[10]||(t[10]=Object(n["createElementVNode"])("br",null,null,-1)),t[11]||(t[11]=Object(n["createElementVNode"])("label",{for:"bankSec"},"Textbook Section:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"bankSec","onUpdate:modelValue":t[2]||(t[2]=e=>l.bankSection=e)},null,512),[[n["vModelText"],l.bankSection]]),t[12]||(t[12]=Object(n["createElementVNode"])("br",null,null,-1)),t[13]||(t[13]=Object(n["createElementVNode"])("input",{type:"submit",value:"Submit"},null,-1))],32),l.error?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",le,Object(n["toDisplayString"])(l.error),1)):Object(n["createCommentVNode"])("",!0)])])}var re={name:"PublisherNewTB",data(){return{bankName:"",bankChapter:"",bankSection:"",textbookId:this.$route.query.textbook_id||"",textbookTitle:this.$route.query.title||"",error:null}},methods:{async saveTestBank(){if(this.bankName&&this.bankChapter&&this.bankSection&&this.textbookId){const t={testbank_name:this.bankName,chapter_number:this.bankChapter,section_number:this.bankSection,textbook_id:this.textbookId};try{const e=await F.post("/testbanks/publisher",t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log("Test bank saved successfully:",e.data),alert("Test bank saved successfully!"),this.$router.push({path:"PubQuestions",query:{title:this.textbookTitle,textbook_id:this.textbookId}})}catch(e){console.error("Error saving test bank:",e),alert("Failed to save the test bank. Please try again.")}}else alert("Please fill out all fields.")}}};o("3af8");const se=s()(re,[["render",ae],["__scopeId","data-v-450c0fea"]]);var ie=se;const de={class:"theme-publisher"},be={class:"top-banner"},ue={class:"banner-title"},me={class:"banner-actions"},pe={class:"page-wrapper"},Oe={class:"button-row"},he={class:"p_dropdown"},je={class:"p_dropbtn"},ke={class:"p_dropdown-content"},Ne=["onClick"],ge={class:"p_dropdown"},Ee={class:"p_dropdown-content"},Ve={id:"selectedQuestionType",style:{color:"#222"},class:"center large-paragraph"},ye=["onClick"],we={key:0,style:{"margin-top":"10px"}},fe=["src"],Te={key:1},ve={key:2},Be={key:3},_e={key:4},xe={key:5,class:"p_button-group"},Ce=["onClick"],Se=["onClick"],Fe=["onClick"],De={class:"form-popup-modal"},Ie={class:"form-container",style:{display:"flex","flex-direction":"column","align-items":"center",gap:"10px","margin-top":"1rem"}},qe=["onClick"],Ae={class:"form-popup-modal"},Me={key:0},Qe=["value"],Pe={key:1},Ue={key:2},Le={key:3},$e={key:4},ze=["onUpdate:modelValue"],He=["onUpdate:modelValue"],Re=["onClick"],We={key:5},Ge={key:6},Je={key:7},Xe=["src"],Ke={key:8},Ye=["src"];function Ze(e,t,o,c,l,a){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",de,[Object(n["createElementVNode"])("div",be,[Object(n["createElementVNode"])("div",ue,Object(n["toDisplayString"])(l.textbookTitle),1),Object(n["createElementVNode"])("div",me,[Object(n["createVNode"])(r,{to:"/PubHome",class:"p_banner-btn"},{default:Object(n["withCtx"])(()=>t[25]||(t[25]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"p_banner-btn"},{default:Object(n["withCtx"])(()=>t[26]||(t[26]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",pe,[Object(n["createElementVNode"])("div",Oe,[Object(n["createElementVNode"])("div",he,[Object(n["createElementVNode"])("button",je,Object(n["toDisplayString"])(l.selectedTestBank?l.selectedTestBank.name:"Select Draft Pool"),1),Object(n["createElementVNode"])("div",ke,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.testBanks,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("a",{key:e.testbank_id,href:"#",onClick:Object(n["withModifiers"])(t=>a.selectTestBank(e),["prevent"])},Object(n["toDisplayString"])(e.name),9,Ne))),128))])]),Object(n["createVNode"])(r,{to:{path:"PubNewTB",query:{title:l.textbookTitle,textbook_id:l.textbookId}}},{default:Object(n["withCtx"])(()=>t[27]||(t[27]=[Object(n["createElementVNode"])("button",{class:"p_button"},"New Draft Pool",-1)])),_:1},8,["to"]),Object(n["createElementVNode"])("div",ge,[t[28]||(t[28]=Object(n["createElementVNode"])("button",{class:"p_dropbtn"},"Question Type",-1)),Object(n["createElementVNode"])("div",Ee,[Object(n["createElementVNode"])("a",{href:"#",onClick:t[0]||(t[0]=e=>a.fetchQuestions("True/False"))},"True/False"),Object(n["createElementVNode"])("a",{href:"#",onClick:t[1]||(t[1]=e=>a.fetchQuestions("Multiple Choice"))},"Multiple Choice"),Object(n["createElementVNode"])("a",{href:"#",onClick:t[2]||(t[2]=e=>a.fetchQuestions("Matching"))},"Matching"),Object(n["createElementVNode"])("a",{href:"#",onClick:t[3]||(t[3]=e=>a.fetchQuestions("Fill in the Blank"))},"Fill in the Blank"),Object(n["createElementVNode"])("a",{href:"#",onClick:t[4]||(t[4]=e=>a.fetchQuestions("Short Answer"))},"Short Answer"),Object(n["createElementVNode"])("a",{href:"#",onClick:t[5]||(t[5]=e=>a.fetchQuestions("Essay"))},"Essay")])]),Object(n["createElementVNode"])("button",{class:"p_button",onClick:t[6]||(t[6]=(...e)=>a.edit&&a.edit(...e))},"New Question")]),Object(n["createElementVNode"])("div",Ve,Object(n["toDisplayString"])(l.selectedQuestionType),1),t[72]||(t[72]=Object(n["createElementVNode"])("hr",null,null,-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.questions,(e,o)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:o,class:Object(n["normalizeClass"])(["p_question-box",{selected:l.selectedQuestionId===e.id}]),onClick:t=>a.toggleQuestionSelection(e.id)},[Object(n["createElementVNode"])("strong",null,"Question "+Object(n["toDisplayString"])(o+1)+":",1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.text),1),t[43]||(t[43]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[29]||(t[29]=Object(n["createElementVNode"])("strong",null,"Type:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.type),1)]),t[44]||(t[44]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[30]||(t[30]=Object(n["createElementVNode"])("strong",null,"Chapter:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.chapter||"N/A"),1)]),t[45]||(t[45]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[31]||(t[31]=Object(n["createElementVNode"])("strong",null,"Section:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.section||"N/A"),1)]),t[46]||(t[46]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[32]||(t[32]=Object(n["createElementVNode"])("strong",null,"Points:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.points),1)]),t[47]||(t[47]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[33]||(t[33]=Object(n["createElementVNode"])("strong",null,"Estimated Time:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.time)+" minutes",1)]),t[48]||(t[48]=Object(n["createElementVNode"])("br",null,null,-1)),e.image_url?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",we,[t[34]||(t[34]=Object(n["createElementVNode"])("strong",null,"Attached Image:",-1)),t[35]||(t[35]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("img",{src:e.image_url,alt:"Attached Image",style:{"max-width":"100%","margin-top":"5px"}},null,8,fe)])):Object(n["createCommentVNode"])("",!0),"True/False"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Te,[t[36]||(t[36]=Object(n["createElementVNode"])("strong",null,"Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.answer?"True":"False"),1)])):Object(n["createCommentVNode"])("",!0),"Multiple Choice"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",ve,[t[37]||(t[37]=Object(n["createElementVNode"])("strong",null,"Correct Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.correctOption&&e.correctOption.option_text||"Not specified"),1),t[38]||(t[38]=Object(n["createElementVNode"])("br",null,null,-1)),t[39]||(t[39]=Object(n["createElementVNode"])("strong",null,"Other Options:",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.incorrectOptions,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.option_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Matching"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Be,[t[40]||(t[40]=Object(n["createElementVNode"])("strong",null,"Pairs:",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.pairs,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.term)+" - "+Object(n["toDisplayString"])(e.definition),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Fill in the Blank"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",_e,[t[41]||(t[41]=Object(n["createElementVNode"])("strong",null,"Correct Answer(s):",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.blanks,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.correct_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("span",null,[t[42]||(t[42]=Object(n["createElementVNode"])("strong",null,"Grading Instructions:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.instructions||"None"),1)]),l.selectedQuestionId===e.id?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",xe,[Object(n["createElementVNode"])("button",{onClick:Object(n["withModifiers"])(t=>a.editQuestion(e),["stop"])},"Edit",8,Ce),Object(n["createElementVNode"])("button",{onClick:Object(n["withModifiers"])(t=>a.deleteQuestion(e.id),["stop"])},"Delete",8,Se),Object(n["createElementVNode"])("button",{onClick:Object(n["withModifiers"])(t=>a.openAddToTestBank(e.id),["stop"])},"Add to Test Bank",8,Fe)])):Object(n["createCommentVNode"])("",!0)],10,ye))),128))]),l.showAddToTBModal?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:0,class:"popup-overlay",onClick:t[8]||(t[8]=Object(n["withModifiers"])((...e)=>a.closeAddToTBModal&&a.closeAddToTBModal(...e),["self"]))},[Object(n["createElementVNode"])("div",De,[t[49]||(t[49]=Object(n["createElementVNode"])("p",{style:{color:"red","font-weight":"bold","text-align":"center","margin-bottom":"1rem"}}," Once the question is added to a draft pool, it can no longer be edited. ",-1)),t[50]||(t[50]=Object(n["createElementVNode"])("h2",{style:{"text-align":"center"}},"Select Draft Pool",-1)),Object(n["createElementVNode"])("div",Ie,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.testBanks,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("button",{key:e.testbank_id,class:"t_button",style:{width:"100%"},onClick:t=>a.assignQuestionToTestBank(e.testbank_id)},Object(n["toDisplayString"])(e.name),9,qe))),128)),Object(n["createElementVNode"])("button",{type:"button",class:"btn cancel",style:{width:"100%"},onClick:t[7]||(t[7]=(...e)=>a.closeAddToTBModal&&a.closeAddToTBModal(...e))}," Close ")])])])):Object(n["createCommentVNode"])("",!0),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",{class:"popup-overlay",onClick:t[24]||(t[24]=Object(n["withModifiers"])((...e)=>a.closeForm&&a.closeForm(...e),["self"]))},[Object(n["createElementVNode"])("div",Ae,[Object(n["createElementVNode"])("form",{class:"form-container",onSubmit:t[23]||(t[23]=Object(n["withModifiers"])((...e)=>a.handleQuestionSave&&a.handleQuestionSave(...e),["prevent"]))},[Object(n["createElementVNode"])("h1",null,Object(n["toDisplayString"])(l.editingQuestionId?"Edit Question":"New Question"),1),t[58]||(t[58]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Chapter Number")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[9]||(t[9]=e=>l.questionData.chapter=e),required:""},null,512),[[n["vModelText"],l.questionData.chapter]]),t[59]||(t[59]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Section Number")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[10]||(t[10]=e=>l.questionData.section=e),required:""},null,512),[[n["vModelText"],l.questionData.section]]),t[60]||(t[60]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Question Type"),Object(n["createElementVNode"])("br")],-1)),l.editingQuestionId?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Me,[Object(n["createElementVNode"])("input",{type:"text",value:l.selectedQuestionType,disabled:"",class:"readonly-input"},null,8,Qe)])):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Pe,[Object(n["withDirectives"])(Object(n["createElementVNode"])("select",{"onUpdate:modelValue":t[11]||(t[11]=e=>l.selectedQuestionType=e),required:""},t[51]||(t[51]=[Object(n["createElementVNode"])("option",{disabled:"",value:""},"Select a type",-1),Object(n["createElementVNode"])("option",null,"True/False",-1),Object(n["createElementVNode"])("option",null,"Multiple Choice",-1),Object(n["createElementVNode"])("option",null,"Matching",-1),Object(n["createElementVNode"])("option",null,"Fill in the Blank",-1),Object(n["createElementVNode"])("option",null,"Short Answer",-1),Object(n["createElementVNode"])("option",null,"Essay",-1)]),512),[[n["vModelSelect"],l.selectedQuestionType]])])),t[61]||(t[61]=Object(n["createElementVNode"])("br",null,null,-1)),t[62]||(t[62]=Object(n["createElementVNode"])("br",null,null,-1)),t[63]||(t[63]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Question Text")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[12]||(t[12]=e=>l.questionData.question=e),required:""},null,512),[[n["vModelText"],l.questionData.question]]),"True/False"===l.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Ue,[t[53]||(t[53]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Answer")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("select",{"onUpdate:modelValue":t[13]||(t[13]=e=>l.questionData.answer=e)},t[52]||(t[52]=[Object(n["createElementVNode"])("option",{value:"True"},"True",-1),Object(n["createElementVNode"])("option",{value:"False"},"False",-1)]),512),[[n["vModelSelect"],l.questionData.answer]])])):Object(n["createCommentVNode"])("",!0),"Multiple Choice"===l.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Le,[t[54]||(t[54]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Correct Answer")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[14]||(t[14]=e=>l.questionData.answer=e)},null,512),[[n["vModelText"],l.questionData.answer]]),t[55]||(t[55]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Incorrect Answer Choices (comma-separated)")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[15]||(t[15]=e=>l.questionData.answerChoices=e)},null,512),[[n["vModelText"],l.questionData.answerChoices]])])):Object(n["createCommentVNode"])("",!0),"Matching"===l.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",$e,[t[56]||(t[56]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Matching Pairs")],-1)),(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.matchingPairs,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:t},[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t=>e.term=t,placeholder:"Term"},null,8,ze),[[n["vModelText"],e.term]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t=>e.definition=t,placeholder:"Definition"},null,8,He),[[n["vModelText"],e.definition]]),Object(n["createElementVNode"])("button",{type:"button",onClick:e=>a.removePair(t)},"Remove",8,Re)]))),128)),Object(n["createElementVNode"])("button",{type:"button",onClick:t[16]||(t[16]=(...e)=>a.addPair&&a.addPair(...e))},"Add Pair")])):Object(n["createCommentVNode"])("",!0),"Fill in the Blank"===l.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",We,[t[57]||(t[57]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Correct Answer")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[17]||(t[17]=e=>l.questionData.answer=e)},null,512),[[n["vModelText"],l.questionData.answer]])])):Object(n["createCommentVNode"])("",!0),"Essay"===l.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Ge)):Object(n["createCommentVNode"])("",!0),t[64]||(t[64]=Object(n["createElementVNode"])("br",null,null,-1)),t[65]||(t[65]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Points Worth")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[18]||(t[18]=e=>l.questionData.points=e),required:""},null,512),[[n["vModelText"],l.questionData.points]]),t[66]||(t[66]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Estimated Time (in minutes)")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[19]||(t[19]=e=>l.questionData.time=e),required:""},null,512),[[n["vModelText"],l.questionData.time]]),t[67]||(t[67]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Grading Instructions")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[20]||(t[20]=e=>l.questionData.instructions=e),required:""},null,512),[[n["vModelText"],l.questionData.instructions]]),t[68]||(t[68]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Attached Image")],-1)),l.editingQuestionId&&l.imagePreview?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Je,[Object(n["createElementVNode"])("img",{src:l.imagePreview,alt:"Attached",style:{"max-width":"100%"}},null,8,Xe)])):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Ke,[Object(n["createElementVNode"])("input",{type:"file",onChange:t[21]||(t[21]=(...e)=>a.handleImageUpload&&a.handleImageUpload(...e)),accept:"image/*"},null,32),l.imagePreview?(Object(n["openBlock"])(),Object(n["createElementBlock"])("img",{key:0,src:l.imagePreview,alt:"Preview",style:{"max-width":"100%"}},null,8,Ye)):Object(n["createCommentVNode"])("",!0)])),t[69]||(t[69]=Object(n["createElementVNode"])("br",null,null,-1)),t[70]||(t[70]=Object(n["createElementVNode"])("br",null,null,-1)),t[71]||(t[71]=Object(n["createElementVNode"])("button",{type:"submit",class:"btn"},"Save",-1)),Object(n["createElementVNode"])("button",{type:"button",class:"btn cancel",onClick:t[22]||(t[22]=(...e)=>a.closeForm&&a.closeForm(...e))},"Close")],32)])],512),[[n["vShow"],l.showForm]])])])}var et={name:"PubQuestions",data(){return{textbookTitle:"",textbookId:"",testBanks:[],selectedTestBank:null,selectedQuestionType:"",questions:[],selectedQuestionId:null,showForm:!1,showAddToTBModal:!1,questionToAddToTB:null,matchingPairs:[],imagePreview:"",editingQuestionId:null,oldMCOptionIds:[],questionData:{chapter:"",section:"",question:"",reference:"",answer:"",answerChoices:"",points:"",time:"",instructions:"",imageFile:null}}},methods:{async handleQuestionSave(){try{let e,t;const o=!!this.editingQuestionId,n=this.questions.find(e=>e.id===this.editingQuestionId);if(this.questionData.imageFile){if(e=new FormData,e.append("file",this.questionData.imageFile),e.append("question_text",this.questionData.question),e.append("default_points",this.questionData.points),e.append("est_time",this.questionData.time),e.append("chapter_number",this.questionData.chapter),e.append("section_number",this.questionData.section),e.append("grading_instructions",this.questionData.instructions),e.append("type",this.selectedQuestionType),e.append("source","manual"),e.append("textbook_id",this.textbookId),"True/False"===this.selectedQuestionType)e.append("true_false_answer","True"===this.questionData.answer);else if("Multiple Choice"===this.selectedQuestionType){const t=this.questionData.answerChoices.split(",").map(e=>e.trim()).filter(Boolean),o=[{option_text:this.questionData.answer.trim(),is_correct:!0},...t.map(e=>({option_text:e,is_correct:!1}))];e.append("options",JSON.stringify(o))}else"Matching"===this.selectedQuestionType?e.append("matches",JSON.stringify(this.matchingPairs.map(e=>({prompt_text:e.term,match_text:e.definition})))):"Fill in the Blank"===this.selectedQuestionType?e.append("blanks",JSON.stringify([{correct_text:this.questionData.answer}])):"Short Answer"===this.selectedQuestionType?e.append("answer",this.questionData.answer):"Essay"===this.selectedQuestionType&&e.append("grading_instructions",this.questionData.instructions);for(let[t,o]of e.entries())console.log(t+":",o);t={headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"multipart/form-data"}}}else{if(e={question_text:this.questionData.question,default_points:parseInt(this.questionData.points),est_time:parseInt(this.questionData.time),chapter_number:this.questionData.chapter,section_number:this.questionData.section,grading_instructions:this.questionData.instructions,type:this.selectedQuestionType,source:"manual",textbook_id:this.textbookId},"True/False"===this.selectedQuestionType)e.true_false_answer="True"===this.questionData.answer;else if("Multiple Choice"===this.selectedQuestionType){const t=this.questionData.answerChoices.split(",").map(e=>e.trim()).filter(Boolean);e.options=[{option_text:this.questionData.answer.trim(),is_correct:!0},...t.map(e=>({option_text:e,is_correct:!1}))],o&&this.oldMCOptionIds.length>0&&(e.to_delete=this.oldMCOptionIds)}else if("Matching"===this.selectedQuestionType){if(e.matches=this.matchingPairs.map(e=>({prompt_text:e.term,match_text:e.definition})),o&&n){const t=(n.pairs||[]).map(e=>e.match_id);e.to_delete=t}}else"Fill in the Blank"===this.selectedQuestionType?e.blanks=[{correct_text:this.questionData.answer}]:"Short Answer"===this.selectedQuestionType?e.answer=this.questionData.answer:"Essay"===this.selectedQuestionType&&(e.grading_instructions=this.questionData.instructions);t={headers:{Authorization:"Bearer "+localStorage.getItem("token")}}}o?await F.patch("/questions/"+this.editingQuestionId,e,t):await F.post("/questions",e,t),alert("Question saved successfully!"),this.closeForm(),this.resetForm(),this.fetchQuestions(this.selectedQuestionType)}catch(e){let t="Something went wrong.";e&&e.response&&e.response.data&&(t=e.response.data.error||e.response.data.message||t),alert("Save failed: "+t),console.error("Error saving question:",e)}},async fetchTestBanks(){try{const e=await F.get("/testbanks/publisher",{params:{textbook_id:this.textbookId},headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.testBanks=e.data.testbanks}catch(e){console.error("Error loading test banks:",e)}},async fetchQuestions(e){this.selectedQuestionType=e;try{const t=await F.get("/questions",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{textbook_id:this.textbookId,type:e}});Array.isArray(t.data.questions)?this.questions=t.data.questions.map(e=>{const t={text:e.question_text,type:e.type,points:e.default_points,id:e.id,instructions:e.grading_instructions||"",time:e.est_time,chapter:e.chapter_number,section:e.section_number,image_url:e.attachment&&e.attachment.url?e.attachment.url:""};switch(e.type){case"True/False":return{...t,answer:e.true_false_answer};case"Multiple Choice":return{...t,correctOption:e.correct_option||null,incorrectOptions:e.incorrect_options||[]};case"Matching":return{...t,pairs:(e.matches||[]).map(e=>({term:e.prompt_text,definition:e.match_text}))};case"Fill in the Blank":return{...t,blanks:e.blanks||[]};case"Short Answer":return t;case"Essay":return t;default:return t}}):this.questions=[]}catch(t){console.error("Error fetching questions:",t),this.questions=[]}},openAddToTestBank(e){this.questionToAddToTB=e,this.showAddToTBModal=!0},closeAddToTBModal(){this.questionToAddToTB=null,this.showAddToTBModal=!1},async assignQuestionToTestBank(e){if(this.questionToAddToTB)try{await F.post(`/testbanks/publisher/${e}/questions`,{question_ids:[this.questionToAddToTB]},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),alert("Question successfully added to testbank!"),this.closeAddToTBModal()}catch(t){console.error("Failed to add question to testbank:",t);let e="Failed to add question.";t.response&&t.response.data&&t.response.data.error&&(e=t.response.data.error),alert(e)}},selectTestBank(e){this.$router.push({name:"PubViewTB",query:{testbank_id:e.testbank_id,name:e.name,textbook_id:this.textbookId,title:this.textbookTitle,chapter:e.chapter_number,section:e.section_number}})},toggleQuestionSelection(e){this.selectedQuestionId=this.selectedQuestionId===e?null:e},selectQuestionType(e){this.selectedQuestionType=e,this.edit()},edit(){this.showForm=!0},closeForm(){this.showForm=!1,this.resetForm()},addPair(){this.matchingPairs.push({term:"",definition:""})},removePair(e){this.matchingPairs.splice(e,1)},handleImageUpload(e){const t=e.target.files[0];if(t){this.questionData.imageFile=t;const e=new FileReader;e.onload=e=>{this.imagePreview=e.target.result},e.readAsDataURL(t)}},resetForm(){this.questionData={chapter:"",section:"",question:"",reference:"",answer:"",answerChoices:"",points:"",time:"",instructions:"",imageFile:null},this.selectedQuestionType="",this.matchingPairs=[],this.imagePreview="",this.editingQuestionId=null,this.oldMCOptionIds=[];const e=document.querySelector('input[type="file"]');e&&(e.value="")},editQuestion(e){this.editingQuestionId=e.id,this.questionData.question=e.text,this.questionData.chapter=e.chapter,this.questionData.section=e.section,this.questionData.points=e.points,this.questionData.time=e.time,this.questionData.instructions=e.instructions,this.questionData.answer=e.answer||"",this.selectedQuestionType=e.type,this.imagePreview=e.image_url||"","Multiple Choice"===e.type?(this.questionData.answer=e.correctOption&&e.correctOption.option_text||"",this.questionData.answerChoices=e.incorrectOptions.map(e=>e.option_text).join(", "),this.oldMCOptionIds=[],e.correctOption&&e.correctOption.option_id&&this.oldMCOptionIds.push(e.correctOption.option_id),Array.isArray(e.incorrectOptions)&&e.incorrectOptions.forEach(e=>{e.option_id&&this.oldMCOptionIds.push(e.option_id)})):"Matching"===e.type&&(this.matchingPairs=e.pairs.map(e=>({term:e.term,definition:e.definition}))),this.showForm=!0},async deleteQuestion(e){if(confirm("Are you sure you want to delete this question?"))try{await F.delete("/questions/"+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),this.questions=this.questions.filter(t=>t.id!==e),alert("Question deleted.")}catch(t){console.error(t),alert("Failed to delete question.")}}},mounted(){this.textbookTitle=this.$route.query.title||"Book Title",this.textbookId=this.$route.query.textbook_id||"",this.textbookId&&this.fetchTestBanks()}};o("5d90");const tt=s()(et,[["render",Ze],["__scopeId","data-v-6d41358c"]]);var ot=tt;const nt={class:"theme-publisher"},ct={class:"top-banner"},lt={class:"banner-title"},at={class:"banner-actions"},rt={class:"center large-paragraph",style:{color:"#222"}},st={id:"feedbackContainer"},it={key:0},dt={key:1},bt={key:2},ut={class:"correct-answer"},mt={key:0};function pt(e,t,o,c,l,a){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",nt,[Object(n["createElementVNode"])("div",ct,[Object(n["createElementVNode"])("div",lt,"Draft Pool: "+Object(n["toDisplayString"])(l.selectedTestBank),1),Object(n["createElementVNode"])("div",at,[Object(n["createVNode"])(r,{to:"/PubHome",class:"p_banner-btn"},{default:Object(n["withCtx"])(()=>t[0]||(t[0]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"p_banner-btn"},{default:Object(n["withCtx"])(()=>t[1]||(t[1]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",rt,[Object(n["createVNode"])(r,{to:{path:"/PubViewTB",query:{title:e.$route.query.title,textbook_id:e.$route.query.textbook_id}}},{default:Object(n["withCtx"])(()=>t[2]||(t[2]=[Object(n["createElementVNode"])("button",{class:"p_button"},"Return to Test Banks",-1)])),_:1},8,["to"]),t[8]||(t[8]=Object(n["createElementVNode"])("hr",null,null,-1)),Object(n["createElementVNode"])("div",st,[l.loading?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",it,"Loading feedback...")):0===l.feedbackList.length?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",dt,"No questions in this test bank have feedback yet.")):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",bt,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.feedbackList,(e,o)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:o,class:"question-box"},[Object(n["createElementVNode"])("p",null,[t[3]||(t[3]=Object(n["createElementVNode"])("strong",null,"Question Type:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.type||"Unknown"),1)]),Object(n["createElementVNode"])("p",null,[t[4]||(t[4]=Object(n["createElementVNode"])("strong",null,"Question:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.question),1)]),Object(n["createElementVNode"])("p",null,[t[5]||(t[5]=Object(n["createElementVNode"])("strong",null,"Correct Answer:",-1)),t[6]||(t[6]=Object(n["createTextVNode"])()),Object(n["createElementVNode"])("span",ut,Object(n["toDisplayString"])(e.correct_answer),1)]),e.feedbacks&&e.feedbacks.length?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",mt,[t[7]||(t[7]=Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("strong",null,"Feedback:")],-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.feedbacks,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},[Object(n["createTextVNode"])(' "'+Object(n["toDisplayString"])(e.comment)+'" — ',1),Object(n["createElementVNode"])("em",null,Object(n["toDisplayString"])(e.username)+" ("+Object(n["toDisplayString"])(e.role)+")",1)]))),128))])])):Object(n["createCommentVNode"])("",!0)]))),128))]))])])])}var Ot={name:"PubViewFeedback",data(){return{testbankId:null,selectedTestBank:this.$route.query.title||"No Test Bank Selected",feedbackList:[],questions:[],loading:!0}},mounted(){const e=this.$route.query;this.testbankId=parseInt(e.testbank_id),this.selectedTestBank=e.title||"No Test Bank Selected",console.log("Parsed testbankId:",this.testbankId),this.fetchQuestionsAndFeedback()},methods:{getCorrectAnswer(e){switch(e.type){case"True/False":return e.true_false_answer?"True":"False";case"Multiple Choice":return e.correct_option?e.correct_option.option_text:"N/A";case"Fill in the Blank":return e.blanks?e.blanks.map(e=>e.correct_text).join(", "):"N/A";case"Matching":return e.matches?e.matches.map(e=>`${e.prompt_text} → ${e.match_text}`).join("; "):"N/A";default:return"N/A"}},async fetchQuestionsAndFeedback(){try{const t=await F.get("/questions",{params:{testbank_id:this.testbankId}});this.questions=t.data.questions,console.log("Raw question objects:",this.questions);const o=[];for(const n of this.questions)try{const e=await F.get("/feedback/question/"+n.id);e.data.length>0&&o.push({question:n.question_text,type:n.type,correct_answer:this.getCorrectAnswer(n),feedbacks:e.data})}catch(e){console.warn("Failed to fetch feedback for question "+n.id,e)}this.feedbackList=o}catch(e){console.error("Error loading feedback:",e)}finally{this.loading=!1}}}};o("8d9a");const ht=s()(Ot,[["render",pt],["__scopeId","data-v-39b8cff6"]]);var jt=ht;const kt={class:"theme-publisher"},Nt={class:"top-banner"},gt={class:"banner-title"},Et={class:"banner-actions"},Vt={class:"page-wrapper"},yt={class:"button-row"},wt=["disabled"],ft=["disabled"],Tt={key:0,class:"popup-overlay"},vt={class:"form-popup-modal"},Bt={key:1,class:"publish-warning"},_t={id:"questionsContainer"},xt=["onClick"],Ct={key:0},St={key:1},Ft={key:2},Dt={key:3},It={key:4},qt={key:5},At={key:6,class:"p_button-group"},Mt=["onClick","disabled"];function Qt(e,t,o,c,l,a){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",kt,[Object(n["createElementVNode"])("div",Nt,[Object(n["createElementVNode"])("div",gt,"Draft Pool: "+Object(n["toDisplayString"])(l.selectedTestBank),1),Object(n["createElementVNode"])("div",Et,[Object(n["createVNode"])(r,{to:"/PubHome",class:"p_banner-btn"},{default:Object(n["withCtx"])(()=>t[9]||(t[9]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"p_banner-btn"},{default:Object(n["withCtx"])(()=>t[10]||(t[10]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",Vt,[Object(n["createElementVNode"])("div",yt,[Object(n["createElementVNode"])("button",{class:"p_button",onClick:t[0]||(t[0]=e=>l.showEditForm=!0)},"Edit Draft Pool Info"),Object(n["createVNode"])(r,{to:{path:"/PubQuestions",query:{title:this.textbookTitle,textbook_id:this.textbookId}}},{default:Object(n["withCtx"])(()=>t[11]||(t[11]=[Object(n["createElementVNode"])("button",{class:"p_button"},"Return to Question Page",-1)])),_:1},8,["to"]),Object(n["createVNode"])(r,{to:{name:"PubViewFeedback",query:{testbank_id:l.selectedTestBankId,title:l.selectedTestBank}}},{default:Object(n["withCtx"])(()=>t[12]||(t[12]=[Object(n["createElementVNode"])("button",{class:"p_button"},"View Feedback",-1)])),_:1},8,["to"]),Object(n["createElementVNode"])("button",{class:"p_button",onClick:t[1]||(t[1]=(...e)=>a.publishTestbank&&a.publishTestbank(...e)),disabled:l.published},Object(n["toDisplayString"])(l.published?"Draft Pool Published":"Publish Draft Pool"),9,wt),Object(n["createElementVNode"])("button",{class:"p_button delete",onClick:t[2]||(t[2]=(...e)=>a.deleteTestBank&&a.deleteTestBank(...e)),disabled:l.published}," Delete Draft Pool ",8,ft)]),l.showEditForm?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Tt,[Object(n["createElementVNode"])("div",vt,[Object(n["createElementVNode"])("form",{class:"form-container",onSubmit:t[7]||(t[7]=Object(n["withModifiers"])((...e)=>a.updateTestBank&&a.updateTestBank(...e),["prevent"]))},[t[13]||(t[13]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("strong",null,"Draft Pool Name:")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>l.editForm.name=e),required:""},null,512),[[n["vModelText"],l.editForm.name]]),t[14]||(t[14]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("strong",null,"Chapter Number:")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>l.editForm.chapter=e),required:""},null,512),[[n["vModelText"],l.editForm.chapter]]),t[15]||(t[15]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("strong",null,"Section Number:")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=e=>l.editForm.section=e),required:""},null,512),[[n["vModelText"],l.editForm.section]]),t[16]||(t[16]=Object(n["createElementVNode"])("button",{type:"submit",class:"btn"},"Save Changes",-1)),Object(n["createElementVNode"])("button",{type:"button",class:"btn cancel",onClick:t[6]||(t[6]=e=>l.showEditForm=!1)},"Cancel")],32)])])):Object(n["createCommentVNode"])("",!0),l.published?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Bt,t[17]||(t[17]=[Object(n["createElementVNode"])("strong",null,"Note:",-1),Object(n["createTextVNode"])(" This draft pool has been published. Question details can no longer be edited or removed. The draft pool cannot be deleted or modified. ")]))):Object(n["createCommentVNode"])("",!0),t[39]||(t[39]=Object(n["createElementVNode"])("hr",null,null,-1)),t[40]||(t[40]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("div",_t,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(a.selectedQuestions,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",{key:e},Object(n["toDisplayString"])(e),1))),128))]),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.questions,(e,o)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:o,class:Object(n["normalizeClass"])(["p_question-box",{selected:l.selectedQuestionId===e.id}]),onClick:t=>a.toggleQuestionSelection(e.id)},[Object(n["createElementVNode"])("strong",null,"Question "+Object(n["toDisplayString"])(o+1)+":",1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.text),1),t[32]||(t[32]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[18]||(t[18]=Object(n["createElementVNode"])("strong",null,"Type:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.type),1)]),t[33]||(t[33]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[19]||(t[19]=Object(n["createElementVNode"])("strong",null,"Chapter:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.chapter||"N/A"),1)]),t[34]||(t[34]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[20]||(t[20]=Object(n["createElementVNode"])("strong",null,"Section:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.section||"N/A"),1)]),t[35]||(t[35]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[21]||(t[21]=Object(n["createElementVNode"])("strong",null,"Points:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.points),1)]),t[36]||(t[36]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[22]||(t[22]=Object(n["createElementVNode"])("strong",null,"Estimated Time:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.time)+" minutes",1)]),t[37]||(t[37]=Object(n["createElementVNode"])("br",null,null,-1)),"True/False"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Ct,[t[23]||(t[23]=Object(n["createElementVNode"])("strong",null,"Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.answer?"True":"False"),1)])):Object(n["createCommentVNode"])("",!0),"Multiple Choice"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",St,[t[24]||(t[24]=Object(n["createElementVNode"])("strong",null,"Correct Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.correctOption&&e.correctOption.option_text||"Not specified"),1),t[25]||(t[25]=Object(n["createElementVNode"])("br",null,null,-1)),t[26]||(t[26]=Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("strong",null,"Other Options:")],-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.incorrectOptions,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t,class:"incorrect-answer"},Object(n["toDisplayString"])(e.option_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Short Answer"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Ft,[t[27]||(t[27]=Object(n["createElementVNode"])("strong",null,"Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.answer||"Not provided"),1)])):Object(n["createCommentVNode"])("",!0),"Fill in the Blank"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Dt,[t[28]||(t[28]=Object(n["createElementVNode"])("strong",null,"Correct Answer(s):",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.blanks,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.correct_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Matching"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",It,[t[29]||(t[29]=Object(n["createElementVNode"])("strong",null,"Pairs:",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.pairs,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.term)+" - "+Object(n["toDisplayString"])(e.definition),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Essay"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",qt,[t[30]||(t[30]=Object(n["createElementVNode"])("strong",null,"Essay Instructions:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.instructions||"None"),1)])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("span",null,[t[31]||(t[31]=Object(n["createElementVNode"])("strong",null,"Grading Instructions:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.instructions||"None"),1)]),t[38]||(t[38]=Object(n["createElementVNode"])("br",null,null,-1)),l.selectedQuestionId===e.id?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",At,[Object(n["createElementVNode"])("button",{onClick:Object(n["withModifiers"])(t=>a.removeQuestionFromTestBank(e.id),["stop"]),disabled:l.published},Object(n["toDisplayString"])(l.published?"Published - Cannot Remove":"Remove from Draft Pool"),9,Mt)])):Object(n["createCommentVNode"])("",!0)],10,xt))),128))]),Object(n["createElementVNode"])("input",{type:"file",id:"fileInput",style:{display:"none"},onChange:t[8]||(t[8]=(...t)=>e.handleFileUpload&&e.handleFileUpload(...t))},null,32)])])}var Pt={name:"PublisherViewTB",data(){return{showPopup:!1,showEditForm:!1,selectedTestBank:this.$route.query.name||"No Test Bank Selected",selectedTestBankId:this.$route.query.testbank_id||this.$route.params.testbank_id||null,textbookId:this.$route.query.textbook_id||null,textbookTitle:this.$route.query.title||null,selectedQuestionId:null,published:!1,questions:[],editForm:{name:this.$route.query.name||"",chapter:this.$route.query.chapter||"",section:this.$route.query.section||""}}},computed:{selectedQuestions(){return this.questions[this.selectedTestBank]||[]}},mounted(){this.loadQuestions()},methods:{selectTestBank(e){this.selectedTestBank=e},edit(){this.showPopup=!0},closeForm(){this.showPopup=!1,this.showEditForm=!1},async updateTestBank(){try{await F.put("/testbanks/publisher/"+this.selectedTestBankId,{name:this.editForm.name,chapter_number:this.editForm.chapter,section_number:this.editForm.section},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),this.selectedTestBank=this.editForm.name,this.showEditForm=!1,alert("Test bank updated successfully.")}catch(e){console.error("Error updating test bank:",e),alert("Failed to update test bank.")}},async loadQuestions(){if(this.selectedTestBankId)try{const e=await F.get(`/testbanks/publisher/${this.selectedTestBankId}/questions`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),t=e.data.questions||[];this.published=e.data.is_published||!1,this.questions=t.map(e=>{const t={id:e.id,text:e.question_text,type:e.type,chapter:e.chapter_number||"N/A",section:e.section_number||"N/A",points:e.default_points||"N/A",time:e.est_time||"N/A",instructions:e.grading_instructions||"None"};switch(e.type){case"True/False":return{...t,answer:e.true_false_answer};case"Multiple Choice":return{...t,correctOption:e.correct_option||null,incorrectOptions:e.incorrect_options||[]};case"Matching":return{...t,pairs:(e.matches||[]).map(e=>({term:e.prompt_text,definition:e.match_text}))};case"Fill in the Blank":return{...t,blanks:e.blanks||[]};case"Short Answer":return{...t,answer:e.answer||""};case"Essay":return t;default:return t}})}catch(e){console.error("Error loading test bank questions:",e)}},toggleQuestionSelection(e){this.selectedQuestionId===e?this.selectedQuestionId=null:this.selectedQuestionId=e},async removeQuestionFromTestBank(e){if(this.published)alert("This test bank is published and cannot be modified.");else if(this.selectedTestBankId){if(confirm("Are you sure you want to remove this question from the test bank?"))try{await F.delete(`/testbanks/${this.selectedTestBankId}/questions/${e}`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),this.questions=this.questions.filter(t=>t.id!==e),this.selectedQuestionId=null,alert("Question removed from test bank.")}catch(t){console.error("Error removing question:",t),alert("Failed to remove question from test bank.")}}else alert("Test bank ID is missing. Cannot remove question.")},async publishTestbank(){if(this.selectedTestBankId)try{await F.post(`/testbanks/${this.selectedTestBankId}/publish`,{},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.published=!0,alert("Test bank published successfully. Questions are now locked.")}catch(e){console.error("Error publishing test bank:",e),alert("Failed to publish test bank.")}},async deleteTestBank(){if(this.published)alert("Cannot delete a published test bank.");else if(confirm("Are you sure you want to delete this entire draft pool? This action cannot be undone."))try{await F.delete("/testbanks/"+this.selectedTestBankId,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),alert("Draft pool deleted successfully."),this.$router.push({path:"/PubQuestions",query:{title:this.textbookTitle,textbook_id:this.textbookId}})}catch(e){console.error("Error deleting draft pool:",e),alert("Failed to delete draft pool.")}}}};o("eba8");const Ut=s()(Pt,[["render",Qt],["__scopeId","data-v-12ad4014"]]);var Lt=Ut;const $t={class:"theme-teacher"},zt={class:"top-banner"},Ht={class:"t_banner-actions"},Rt={class:"center large-paragraph",style:{color:"#222"}},Wt={class:"page-wrapper"},Gt={class:"button-row"},Jt={key:0,class:"t_dropdown"},Xt={class:"t_dropdown-content"},Kt=["onClick"],Yt={key:1};function Zt(e,t,o,c,l,a){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",$t,[Object(n["createElementVNode"])("div",zt,[t[1]||(t[1]=Object(n["createElementVNode"])("div",{class:"banner-title"},"Course Selection",-1)),Object(n["createElementVNode"])("div",Ht,[Object(n["createVNode"])(r,{to:"/",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[0]||(t[0]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",Rt,[Object(n["createElementVNode"])("div",Wt,[t[4]||(t[4]=Object(n["createTextVNode"])(" Please select or create a course: ")),Object(n["createElementVNode"])("div",Gt,[l.courses.length?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Jt,[t[2]||(t[2]=Object(n["createElementVNode"])("button",{class:"t_dropbtn"},"Select Course",-1)),Object(n["createElementVNode"])("div",Xt,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.courses,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("a",{key:e.id,onClick:t=>a.selectCourse(e)},Object(n["toDisplayString"])(e.title),9,Kt))),128))])])):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Yt," No courses available. ")),Object(n["createVNode"])(r,{to:"TeacherNewClass"},{default:Object(n["withCtx"])(()=>t[3]||(t[3]=[Object(n["createElementVNode"])("button",{class:"t_button"},"Create New Course",-1)])),_:1})])])]),t[5]||(t[5]=Object(n["createElementVNode"])("br",null,null,-1))])}var eo={name:"TeacherHome",data(){return{courses:[],error:null}},created(){this.fetchCourses()},methods:{async fetchCourses(){try{console.log("Fetching courses...");const e=await F.get("/courses",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log("Courses fetched:",e.data),Array.isArray(e.data)?this.courses=e.data.map(e=>({id:e.course_id,title:e.course_name,textbook_id:e.textbook_id})):this.error="Failed to fetch course data."}catch(e){console.error("Error fetching course:",e),e.response?this.error=e.response.data.error||e.response.statusText:this.error="Network error or server is not responding."}},selectCourse(e){this.$router.push({name:"TeacherQuestions",query:{courseId:e.id,courseTitle:e.title,textbook_id:e.textbook_id}})}}};o("d23e");const to=s()(eo,[["render",Zt],["__scopeId","data-v-24e4f4d8"]]);var oo=to;const no={class:"theme-teacher"},co={class:"center large-paragraph",style:{color:"#222"}},lo=["disabled"],ao={key:0,class:"error-message"},ro={key:1,class:"loading-message"};function so(e,t,o,c,l,a){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",no,[t[14]||(t[14]=Object(n["createElementVNode"])("div",{class:"top-banner"},[Object(n["createElementVNode"])("div",{class:"banner-title"},"Teacher Login")],-1)),Object(n["createElementVNode"])("div",co,[t[11]||(t[11]=Object(n["createTextVNode"])(" Please enter your teacher username and password: ")),t[12]||(t[12]=Object(n["createElementVNode"])("br",null,null,-1)),t[13]||(t[13]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("form",{onSubmit:t[2]||(t[2]=Object(n["withModifiers"])((...e)=>a.submitForm&&a.submitForm(...e),["prevent"]))},[t[3]||(t[3]=Object(n["createElementVNode"])("label",{for:"uname"},"Username:",-1)),t[4]||(t[4]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"uname","onUpdate:modelValue":t[0]||(t[0]=e=>l.username=e)},null,512),[[n["vModelText"],l.username]]),t[5]||(t[5]=Object(n["createElementVNode"])("br",null,null,-1)),t[6]||(t[6]=Object(n["createElementVNode"])("br",null,null,-1)),t[7]||(t[7]=Object(n["createElementVNode"])("label",{for:"pass"},"Password:",-1)),t[8]||(t[8]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"password",id:"pass","onUpdate:modelValue":t[1]||(t[1]=e=>l.password=e)},null,512),[[n["vModelText"],l.password]]),t[9]||(t[9]=Object(n["createElementVNode"])("br",null,null,-1)),t[10]||(t[10]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("input",{type:"submit",value:"Submit",disabled:l.loading},null,8,lo)],32),l.errorMessage?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",ao,Object(n["toDisplayString"])(l.errorMessage),1)):Object(n["createCommentVNode"])("",!0),l.loading?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",ro,"Logging in...")):Object(n["createCommentVNode"])("",!0)])])}var io={data(){return{username:"",password:"",errorMessage:"",loading:!1}},mounted(){const e=localStorage.getItem("token");if(e)try{const t=Object(D["default"])(e),o=Date.now()/1e3;t.exp>o&&"teacher"===t.role&&this.$router.push("/TeacherHome")}catch(t){console.error("Invalid token",t)}},methods:{async submitForm(){if(this.username&&this.password)if(this.username.trim().length<3||this.password.trim().length<6)this.errorMessage="Username must be at least 3 characters and password at least 6 characters.";else{this.loading=!0,this.errorMessage="";try{const e=await F.post("/auth/login",{username:this.username.toLowerCase(),password:this.password}),{token:t,user_id:o,role:n}=e.data;localStorage.setItem("token",t),localStorage.setItem("user_id",o),localStorage.setItem("role",n),"teacher"===n?this.$router.push("/TeacherHome"):(this.errorMessage="Only teachers can log in here.",localStorage.clear())}catch(e){e.response?401===e.response.status?this.errorMessage="Invalid username or password.":this.errorMessage=e.response&&e.response.data&&e.response.data.message||"An error occurred during login.":this.errorMessage="Network error. Please check your connection."}finally{this.loading=!1}}else this.errorMessage="Please enter both username and password."}}};o("b7ca");const bo=s()(io,[["render",so],["__scopeId","data-v-b879ec9e"]]);var uo=bo;const mo={class:"theme-teacher"},po={class:"top-banner"},Oo={class:"t_banner-actions"},ho={class:"center large-paragraph",style:{color:"#222"}},jo=["value"],ko={key:0,style:{color:"red","margin-top":"10px"}};function No(e,t,o,c,l,a){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",mo,[Object(n["createElementVNode"])("div",po,[t[6]||(t[6]=Object(n["createElementVNode"])("div",{class:"banner-title"},"Create New Class",-1)),Object(n["createElementVNode"])("div",Oo,[Object(n["createVNode"])(r,{to:"/TeacherHome",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[4]||(t[4]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[5]||(t[5]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",ho,[Object(n["createElementVNode"])("form",{onSubmit:t[3]||(t[3]=Object(n["withModifiers"])((...e)=>a.saveCourse&&a.saveCourse(...e),["prevent"]))},[t[7]||(t[7]=Object(n["createElementVNode"])("label",{for:"courseTitle"},"Course Title:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"courseTitle","onUpdate:modelValue":t[0]||(t[0]=e=>l.courseTitle=e),style:{height:"20px"}},null,512),[[n["vModelText"],l.courseTitle]]),t[8]||(t[8]=Object(n["createElementVNode"])("br",null,null,-1)),t[9]||(t[9]=Object(n["createElementVNode"])("label",{for:"courseNumber"},"Course Number:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"courseNumber","onUpdate:modelValue":t[1]||(t[1]=e=>l.courseNumber=e),style:{height:"20px"}},null,512),[[n["vModelText"],l.courseNumber]]),t[10]||(t[10]=Object(n["createElementVNode"])("br",null,null,-1)),t[11]||(t[11]=Object(n["createElementVNode"])("label",{for:"textbookTitle"},"Textbook Title:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("select",{id:"textbookTitle","onUpdate:modelValue":t[2]||(t[2]=e=>l.selectedTextbookId=e),style:{height:"50px",width:"200px"},required:""},[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.textbooks,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("option",{key:e.id,value:e.id},Object(n["toDisplayString"])(e.title),9,jo))),128))],512),[[n["vModelSelect"],l.selectedTextbookId]]),l.textbooks.length?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",ko," No textbooks available. ")),t[12]||(t[12]=Object(n["createElementVNode"])("br",null,null,-1)),t[13]||(t[13]=Object(n["createElementVNode"])("div",{class:"center large-heading"},[Object(n["createElementVNode"])("input",{type:"submit",value:"Save"})],-1))],32)])])}var go={name:"TeacherNewClass",data(){return{courseTitle:"",courseNumber:"",selectedTextbookId:null,textbooks:[],error:null}},created(){this.fetchTextbooks()},methods:{async fetchTextbooks(){try{console.log("Fetching textbooks...");const e=await F.get("/textbooks/all",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log("Textbooks fetched:",e.data),e.data&&e.data.textbooks?this.textbooks=e.data.textbooks:this.error="Failed to fetch textbooks data."}catch(e){console.error("Error fetching textbooks:",e),e.response?this.error=`Error: ${e.response.status} - ${e.response.data.message||e.response.statusText}`:this.error="Network error or server is not responding."}},selectTextbook(e){this.selectedTextbookId=e.id,this.selectedTextbookTitle=e.title},async saveCourse(){if(this.courseTitle&&this.courseNumber&&this.selectedTextbookId){const t={course_name:this.courseTitle,course_number:this.courseNumber,textbook_id:this.selectedTextbookId};try{const e=await F.post("/courses",t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log("Course saved successfully:",e.data),alert("Course saved successfully!"),this.$router.push({path:"/TeacherHome"})}catch(e){console.error("Error saving course:",e),alert("Failed to save the course. Please try again.")}}else alert("Please fill out all fields.")}}};o("31d1");const Eo=s()(go,[["render",No],["__scopeId","data-v-64c2e3b9"]]);var Vo=Eo;const yo={class:"theme-teacher"},wo={class:"top-banner"},fo={class:"t_banner-actions"},To={class:"center large-paragraph",style:{color:"#222"}};function vo(e,t,o,c,l,a){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",yo,[Object(n["createElementVNode"])("div",wo,[t[6]||(t[6]=Object(n["createElementVNode"])("div",{class:"banner-title"},"Create New Draft Pool",-1)),Object(n["createElementVNode"])("div",fo,[Object(n["createVNode"])(r,{to:"/TeacherHome",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[4]||(t[4]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[5]||(t[5]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",To,[Object(n["createElementVNode"])("form",{onSubmit:t[3]||(t[3]=Object(n["withModifiers"])((...e)=>a.saveTestBank&&a.saveTestBank(...e),["prevent"]))},[t[7]||(t[7]=Object(n["createElementVNode"])("label",{for:"bankName"},"Name of Draft Pool:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"bankName","onUpdate:modelValue":t[0]||(t[0]=e=>l.bankName=e),style:{height:"20px"}},null,512),[[n["vModelText"],l.bankName]]),t[8]||(t[8]=Object(n["createElementVNode"])("br",null,null,-1)),t[9]||(t[9]=Object(n["createElementVNode"])("br",null,null,-1)),t[10]||(t[10]=Object(n["createElementVNode"])("label",{for:"bankCh"},"Textbook Chapter:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"bankCh","onUpdate:modelValue":t[1]||(t[1]=e=>l.bankChapter=e),style:{height:"20px"}},null,512),[[n["vModelText"],l.bankChapter]]),t[11]||(t[11]=Object(n["createElementVNode"])("br",null,null,-1)),t[12]||(t[12]=Object(n["createElementVNode"])("br",null,null,-1)),t[13]||(t[13]=Object(n["createElementVNode"])("label",{for:"bankSec"},"Textbook Section:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"bankSec","onUpdate:modelValue":t[2]||(t[2]=e=>l.bankSection=e),style:{height:"20px"}},null,512),[[n["vModelText"],l.bankSection]]),t[14]||(t[14]=Object(n["createElementVNode"])("br",null,null,-1)),t[15]||(t[15]=Object(n["createElementVNode"])("br",null,null,-1)),t[16]||(t[16]=Object(n["createElementVNode"])("input",{type:"submit",value:"Submit"},null,-1))],32)])])}var Bo={name:"TeacherNewTB",data(){return{courseId:this.$route.query.courseId||"",courseTitle:this.$route.query.courseTitle||"",bankName:"",bankChapter:"",bankSection:""}},methods:{async saveTestBank(){if(this.bankName&&this.bankChapter&&this.bankSection&&this.courseId){const t={testbank_name:this.bankName,chapter_number:this.bankChapter,section_number:this.bankSection,course_id:this.courseId};try{const e=await F.post("/testbanks/teacher",t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log("Test bank saved successfully:",e.data),alert("Test bank saved successfully!"),this.$router.push({path:"/TeacherQuestions",query:{courseTitle:this.courseTitle,courseId:this.courseId}})}catch(e){console.error("Error saving test bank:",e),alert("Failed to save the test bank. Please try again.")}}else alert("Please fill out all fields.")}}};o("8bca");const _o=s()(Bo,[["render",vo],["__scopeId","data-v-e206ccd2"]]);var xo=_o;const Co={class:"teacher-newTest-container"},So={class:"center large-paragraph"},Fo={class:"box",style:{width:"250px"}},Do={class:"container"},Io={class:"box"},qo={class:"form-popup",id:"test_view"},Ao={class:"form-container"},Mo={class:"r_container"},Qo={class:"r_container"},Po={class:"r_container"};function Uo(e,t,o,c,l,a){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Co,[t[27]||(t[27]=Object(n["createElementVNode"])("div",{class:"center large-heading sticky"},[Object(n["createElementVNode"])("h1",null,"Create Test")],-1)),Object(n["createElementVNode"])("div",So,[Object(n["createElementVNode"])("div",Fo,[Object(n["createElementVNode"])("label",Do,[t[11]||(t[11]=Object(n["createTextVNode"])("Add Cover Page ")),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>l.coverPage=e)},null,512),[[n["vModelCheckbox"],l.coverPage]]),t[12]||(t[12]=Object(n["createElementVNode"])("span",{class:"checkmark"},null,-1))])]),t[15]||(t[15]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[1]||(t[1]=(...e)=>a.edit&&a.edit(...e))},"Template Options"),t[16]||(t[16]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[2]||(t[2]=(...e)=>a.importGraphic&&a.importGraphic(...e))},"Add Embedded Graphic"),t[17]||(t[17]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("div",Io,[t[13]||(t[13]=Object(n["createElementVNode"])("label",{for:"est"},"Time Allowed:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"est","onUpdate:modelValue":t[3]||(t[3]=e=>l.timeAllowed=e),style:{height:"20px"}},null,512),[[n["vModelText"],l.timeAllowed]]),t[14]||(t[14]=Object(n["createElementVNode"])("br",null,null,-1))]),t[18]||(t[18]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[4]||(t[4]=(...e)=>a.generateTest&&a.generateTest(...e))},"Generate Test")]),Object(n["createElementVNode"])("input",{type:"file",id:"fileInput",style:{display:"none"},onChange:t[5]||(t[5]=(...e)=>a.handleFileUpload&&a.handleFileUpload(...e))},null,32),Object(n["createElementVNode"])("div",qo,[Object(n["createElementVNode"])("form",Ao,[t[25]||(t[25]=Object(n["createTextVNode"])(" Please select which template to use")),t[26]||(t[26]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("label",Mo,[t[19]||(t[19]=Object(n["createTextVNode"])("Default ")),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"radio",value:"Default","onUpdate:modelValue":t[6]||(t[6]=e=>l.selectedTemplate=e),name:"template"},null,512),[[n["vModelRadio"],l.selectedTemplate]]),t[20]||(t[20]=Object(n["createElementVNode"])("span",{class:"checkmark"},null,-1))]),Object(n["createElementVNode"])("label",Qo,[t[21]||(t[21]=Object(n["createTextVNode"])("Mixed ")),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"radio",value:"Mixed","onUpdate:modelValue":t[7]||(t[7]=e=>l.selectedTemplate=e),name:"template"},null,512),[[n["vModelRadio"],l.selectedTemplate]]),t[22]||(t[22]=Object(n["createElementVNode"])("span",{class:"checkmark"},null,-1))]),Object(n["createElementVNode"])("label",Po,[t[23]||(t[23]=Object(n["createTextVNode"])("ETC ")),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"radio",value:"ETC","onUpdate:modelValue":t[8]||(t[8]=e=>l.selectedTemplate=e),name:"template"},null,512),[[n["vModelRadio"],l.selectedTemplate]]),t[24]||(t[24]=Object(n["createElementVNode"])("span",{class:"checkmark"},null,-1))]),Object(n["createElementVNode"])("button",{type:"button",class:"btn",onClick:t[9]||(t[9]=(...e)=>a.saveTemplate&&a.saveTemplate(...e))},"Save"),Object(n["createElementVNode"])("button",{type:"button",class:"btn cancel",onClick:t[10]||(t[10]=(...e)=>a.closeForm&&a.closeForm(...e))},"Close")])])])}var Lo={name:"TeacherNewTest",data(){return{coverPage:!0,selectedTemplate:"Default",timeAllowed:"",uploadedImage:"",showPopup:!1}},methods:{importGraphic(){document.getElementById("fileInput").click()},handleFileUpload(e){const t=e.target.files[0];t&&(console.log("File selected:",t.name),localStorage.setItem("uploadedImage",t.name),this.uploadedImage=t.name)},generateTest(){const e={coverPage:this.coverPage,selectedTemplate:this.selectedTemplate,uploadedImage:this.uploadedImage,timeAllowed:this.timeAllowed};localStorage.setItem("testOptions",JSON.stringify(e)),this.$router.push({path:"TeacherTemplate"})},edit(){document.getElementById("test_view").style.display="block"},closeForm(){document.getElementById("test_view").style.display="none"},saveTemplate(){this.closeForm()}}};o("e004");const $o=s()(Lo,[["render",Uo],["__scopeId","data-v-32550516"]]);var zo=$o;const Ho={class:"theme-teacher"},Ro={class:"top-banner"},Wo={class:"t_banner-actions"},Go={class:"center large-paragraph",style:{color:"#222"}},Jo={class:"button-row"},Xo={key:0},Ko=["onClick"],Yo={key:0},Zo={key:1},en={key:2},tn={key:3},on={key:4},nn={key:5},cn={key:6,class:"button-group"},ln=["onClick"],an=["onClick"],rn={key:1},sn={key:0,class:"center large-paragraph",style:{color:"#222"}},dn={key:1},bn=["onClick"],un={key:0},mn={key:1},pn={key:2},On={key:3},hn={key:4},jn={key:5},kn={key:6,class:"button-group"},Nn=["onClick"],gn=["onClick"],En={class:"form-popup-modal"},Vn={class:"form-popup-modal"},yn={key:0},wn=["onClick"];function fn(e,t,o,c,l,a){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Ho,[Object(n["createElementVNode"])("div",Ro,[t[10]||(t[10]=Object(n["createElementVNode"])("div",{class:"banner-title"},"Community Resources",-1)),Object(n["createElementVNode"])("div",Wo,[Object(n["createVNode"])(r,{to:"/TeacherHome",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[8]||(t[8]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[9]||(t[9]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",Go,[t[43]||(t[43]=Object(n["createTextVNode"])(" Please select an option to view: ")),Object(n["createElementVNode"])("div",Jo,[Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[0]||(t[0]=(...e)=>a.viewPublishedTests&&a.viewPublishedTests(...e))},"Published Tests"),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[1]||(t[1]=(...e)=>a.fetchFeedback&&a.fetchFeedback(...e))},"View Community Draft Pools")]),"published"===l.viewing?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Xo,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.fullTestbanks,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:e.testbank_id,class:"published-bank"},[Object(n["createElementVNode"])("h3",null,Object(n["toDisplayString"])(e.name)+" (Chapter "+Object(n["toDisplayString"])(e.chapter_number)+", Section "+Object(n["toDisplayString"])(e.section_number)+")",1),(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.questions,(e,o)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:e.id,class:Object(n["normalizeClass"])(["question-box",{selected:l.selectedQuestionId===e.id}]),onClick:t=>a.toggleQuestionSelection(e.id)},[Object(n["createElementVNode"])("strong",null,"Question "+Object(n["toDisplayString"])(o+1)+":",1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.question_text),1),t[23]||(t[23]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[11]||(t[11]=Object(n["createElementVNode"])("strong",null,"Type:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.type),1)]),t[24]||(t[24]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[12]||(t[12]=Object(n["createElementVNode"])("strong",null,"Chapter:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.chapter_number||"N/A"),1)]),t[25]||(t[25]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[13]||(t[13]=Object(n["createElementVNode"])("strong",null,"Section:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.section_number||"N/A"),1)]),t[26]||(t[26]=Object(n["createElementVNode"])("br",null,null,-1)),"True/False"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Yo,[t[14]||(t[14]=Object(n["createElementVNode"])("strong",null,"Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.true_false_answer?"True":"False"),1)])):Object(n["createCommentVNode"])("",!0),"Multiple Choice"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Zo,[t[15]||(t[15]=Object(n["createElementVNode"])("span",{class:"correct-answer"},"Correct Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.correct_option&&e.correct_option.option_text||"Not specified")+" ",1),t[16]||(t[16]=Object(n["createElementVNode"])("br",null,null,-1)),t[17]||(t[17]=Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("strong",null,"Other Options:")],-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.incorrect_options,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t,class:"incorrect-answer"},Object(n["toDisplayString"])(e.option_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Matching"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",en,[t[18]||(t[18]=Object(n["createElementVNode"])("strong",null,"Pairs:",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.matches,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.prompt_text)+" - "+Object(n["toDisplayString"])(e.match_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Fill in the Blank"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",tn,[t[19]||(t[19]=Object(n["createElementVNode"])("strong",null,"Correct Answers:",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.blanks,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.correct_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Short Answer"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",on,[t[20]||(t[20]=Object(n["createElementVNode"])("strong",null,"Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.answer||"Not provided"),1)])):Object(n["createCommentVNode"])("",!0),"Essay"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",nn,[t[21]||(t[21]=Object(n["createElementVNode"])("strong",null,"Essay Instructions:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.grading_instructions||"None"),1)])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",null,[t[22]||(t[22]=Object(n["createElementVNode"])("strong",null,"Grading Instructions:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.grading_instructions||"None"),1)]),l.selectedQuestionId===e.id?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",cn,[Object(n["createElementVNode"])("button",{onClick:Object(n["withModifiers"])(t=>a.openFeedbackForm(e.id),["stop"])},"Leave Feedback",8,ln),Object(n["createElementVNode"])("button",{onClick:Object(n["withModifiers"])(t=>a.openTestBankModal(e.id),["stop"])},"Add to Draft Pool",8,an)])):Object(n["createCommentVNode"])("",!0)],10,Ko))),128))]))),128))])):Object(n["createCommentVNode"])("",!0),"published-tests"===l.viewing?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",rn,[0===l.fullTestbanks.length?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",sn," No published tests available for this course. ")):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",dn)),(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.fullTestbanks,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:e.testbank_id,class:"published-bank"},[Object(n["createElementVNode"])("h3",null,Object(n["toDisplayString"])(e.name)+" (Chapter "+Object(n["toDisplayString"])(e.chapter_number)+", Section "+Object(n["toDisplayString"])(e.section_number)+")",1),(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.questions,(e,o)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:e.id,class:Object(n["normalizeClass"])(["question-box",{selected:l.selectedQuestionId===e.id}]),onClick:t=>a.toggleQuestionSelection(e.id)},[Object(n["createElementVNode"])("strong",null,"Question "+Object(n["toDisplayString"])(o+1)+":",1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.question_text),1),t[39]||(t[39]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[27]||(t[27]=Object(n["createElementVNode"])("strong",null,"Type:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.type),1)]),t[40]||(t[40]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[28]||(t[28]=Object(n["createElementVNode"])("strong",null,"Chapter:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.chapter_number||"N/A"),1)]),t[41]||(t[41]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[29]||(t[29]=Object(n["createElementVNode"])("strong",null,"Section:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.section_number||"N/A"),1)]),t[42]||(t[42]=Object(n["createElementVNode"])("br",null,null,-1)),"True/False"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",un,[t[30]||(t[30]=Object(n["createElementVNode"])("strong",null,"Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.true_false_answer?"True":"False"),1)])):Object(n["createCommentVNode"])("",!0),"Multiple Choice"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",mn,[t[31]||(t[31]=Object(n["createElementVNode"])("span",{class:"correct-answer"},"Correct Answer:",-1)),Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.correct_option&&e.correct_option.option_text||"Not specified")+" ",1),t[32]||(t[32]=Object(n["createElementVNode"])("br",null,null,-1)),t[33]||(t[33]=Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("strong",null,"Other Options:")],-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.incorrect_options,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t,class:"incorrect-answer"},Object(n["toDisplayString"])(e.option_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Matching"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",pn,[t[34]||(t[34]=Object(n["createElementVNode"])("strong",null,"Pairs:",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.matches,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.prompt_text)+" - "+Object(n["toDisplayString"])(e.match_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Fill in the Blank"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",On,[t[35]||(t[35]=Object(n["createElementVNode"])("strong",null,"Correct Answers:",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.blanks,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.correct_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Short Answer"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",hn,[t[36]||(t[36]=Object(n["createElementVNode"])("strong",null,"Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.answer||"Not provided"),1)])):Object(n["createCommentVNode"])("",!0),"Essay"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",jn,[t[37]||(t[37]=Object(n["createElementVNode"])("strong",null,"Essay Instructions:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.grading_instructions||"None"),1)])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",null,[t[38]||(t[38]=Object(n["createElementVNode"])("strong",null,"Grading Instructions:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.grading_instructions||"None"),1)]),l.selectedQuestionId===e.id?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",kn,[Object(n["createElementVNode"])("button",{onClick:Object(n["withModifiers"])(t=>a.openFeedbackForm(e.id),["stop"])},"Leave Feedback",8,Nn),Object(n["createElementVNode"])("button",{onClick:Object(n["withModifiers"])(t=>a.openTestBankModal(e.id),["stop"])},"Add to Draft Pool",8,gn)])):Object(n["createCommentVNode"])("",!0)],10,bn))),128))]))),128))])):Object(n["createCommentVNode"])("",!0)]),l.showFeedbackForm?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:0,class:"popup-overlay",onClick:t[5]||(t[5]=Object(n["withModifiers"])((...e)=>a.closeFeedbackForm&&a.closeFeedbackForm(...e),["self"]))},[Object(n["createElementVNode"])("div",En,[t[44]||(t[44]=Object(n["createElementVNode"])("h2",null,"Leave Feedback",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("textarea",{"onUpdate:modelValue":t[2]||(t[2]=e=>l.feedbackText=e),rows:"5",style:{width:"100%",padding:"10px"},placeholder:"Enter your comment here..."},null,512),[[n["vModelText"],l.feedbackText]]),t[45]||(t[45]=Object(n["createElementVNode"])("br",null,null,-1)),t[46]||(t[46]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("button",{class:"btn",onClick:t[3]||(t[3]=(...e)=>a.submitFeedback&&a.submitFeedback(...e))},"Submit"),Object(n["createElementVNode"])("button",{class:"btn cancel",onClick:t[4]||(t[4]=(...e)=>a.closeFeedbackForm&&a.closeFeedbackForm(...e))},"Cancel")])])):Object(n["createCommentVNode"])("",!0),l.showTestBankModal?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:1,class:"popup-overlay",onClick:t[7]||(t[7]=Object(n["withModifiers"])((...e)=>a.closeTestBankModal&&a.closeTestBankModal(...e),["self"]))},[Object(n["createElementVNode"])("div",Vn,[t[47]||(t[47]=Object(n["createElementVNode"])("h2",null,"Select a Draft Pool",-1)),l.testBanks.length?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",yn,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.testBanks,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("button",{key:e.testbank_id,class:"t_button",onClick:t=>a.assignToDraftPool(e.testbank_id),style:{"margin-bottom":"10px",display:"block",width:"100%"}},Object(n["toDisplayString"])(e.name),9,wn))),128))])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("button",{class:"btn cancel",onClick:t[6]||(t[6]=(...e)=>a.closeTestBankModal&&a.closeTestBankModal(...e))},"Cancel")])])):Object(n["createCommentVNode"])("",!0)])}var Tn={name:"TeacherPubQ",data(){return{courseId:"",fullTestbanks:[],viewing:"",showFeedbackForm:!1,selectedQuestionIdForFeedback:null,feedbackText:"",testBanks:[],selectedQuestionToAdd:null,showTestBankModal:!1,selectedQuestionId:null}},mounted(){this.courseId=this.$route.query.course_id,console.log("Course ID:",this.courseId),this.fetchTeacherTestbanks()},methods:{async fetchFeedback(){this.viewing="published";try{const e=await F.get("/resources/full-testbanks?course_id="+this.courseId,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.fullTestbanks=e.data.testbanks||[],console.log("Full published testbanks loaded:",this.fullTestbanks)}catch(e){console.error("Failed to load testbanks:",e),alert("Could not load published testbanks.")}},openFeedbackForm(e){this.selectedQuestionIdForFeedback=e,this.feedbackText="",this.showFeedbackForm=!0},closeFeedbackForm(){this.selectedQuestionIdForFeedback=null,this.feedbackText="",this.showFeedbackForm=!1},async submitFeedback(){try{await F.post("/feedback/create",{question_id:this.selectedQuestionIdForFeedback,comment_field:this.feedbackText},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),alert("Feedback submitted!"),this.closeFeedbackForm()}catch(e){console.error("Error submitting feedback:",e),alert("Failed to submit feedback.")}},async fetchTeacherTestbanks(){try{const e=await F.get("/testbanks/teacher?course_id="+this.courseId,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.testBanks=e.data.testbanks||[]}catch(e){console.error("Failed to load testbanks:",e)}},openTestBankModal(e){this.selectedQuestionToAdd=e,this.showTestBankModal=!0},closeTestBankModal(){this.selectedQuestionToAdd=null,this.showTestBankModal=!1},async assignToDraftPool(e){try{await F.post(`/testbanks/${e}/questions`,{question_ids:[this.selectedQuestionToAdd]},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),alert("Question added to the selected draft pool!"),this.closeTestBankModal()}catch(t){console.error("Failed to add question:",t),alert("Could not add question to the selected pool.")}},toggleQuestionSelection(e){this.selectedQuestionId=this.selectedQuestionId===e?null:e},async viewPublishedTests(){this.viewing="published-tests",this.fullTestbanks=[];const e=this.$route.query.textbook_id;if(e)try{const t=await F.get("/tests/published",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),o=(t.data||[]).filter(t=>t.textbook_id==e);for(const e of o){const t=await F.get(`/resources/tests/${e.test_id}/questions`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.fullTestbanks.push({testbank_id:e.test_id,name:e.name||"Test "+e.test_id,chapter_number:"N/A",section_number:"N/A",questions:t.data.questions||[]})}console.log("Published test questions loaded:",this.fullTestbanks)}catch(t){console.error("Failed to load published tests:",t),alert("Could not load published test questions.")}else console.error("Missing textbook_id in route.")}}};o("14ef");const vn=s()(Tn,[["render",fn]]);var Bn=vn;const _n={class:"theme-teacher"},xn={class:"top-banner"},Cn={class:"banner-title"},Sn={class:"t_banner-actions"},Fn={class:"page-wrapper"},Dn={class:"button-row"},In={class:"t_dropdown"},qn={class:"t_dropbtn"},An={class:"t_dropdown-content"},Mn=["onClick"],Qn={class:"t_dropdown"},Pn={class:"t_dropdown-content"},Un={id:"selectedQuestionType",style:{color:"#222"},class:"center large-paragraph"},Ln=["onClick"],$n={key:0},zn={key:1},Hn={key:2},Rn={key:3},Wn={key:4},Gn=["src"],Jn={key:5,class:"button-group"},Xn=["onClick"],Kn=["onClick"],Yn=["onClick"],Zn={class:"form-popup-modal"},ec={style:{display:"flex","flex-direction":"column","align-items":"flex-start"}},tc=["onClick"],oc={class:"form-container",style:{width:"100%"}},nc={class:"form-popup-modal"},cc={key:0},lc={key:1},ac=["value"],rc={key:2},sc={key:3},ic={key:4},dc=["onUpdate:modelValue"],bc=["onUpdate:modelValue"],uc=["onClick"],mc={key:5},pc={key:6},Oc={key:7},hc=["src"],jc={key:8},kc=["src"],Nc={class:"form-popup-modal"};function gc(e,t,o,c,l,a){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",_n,[Object(n["createElementVNode"])("div",xn,[Object(n["createElementVNode"])("div",Cn,Object(n["toDisplayString"])(l.courseTitle),1),Object(n["createElementVNode"])("div",Sn,[Object(n["createVNode"])(r,{to:"/TeacherHome",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[33]||(t[33]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[34]||(t[34]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",Fn,[Object(n["createElementVNode"])("div",Dn,[Object(n["createElementVNode"])("div",In,[Object(n["createElementVNode"])("button",qn,Object(n["toDisplayString"])(e.selectedTestBank?e.selectedTestBank.name:"Select Draft Pool"),1),Object(n["createElementVNode"])("div",An,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.testBanks,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("a",{key:e.testbank_id,href:"#",onClick:Object(n["withModifiers"])(t=>a.selectTestBank(e),["prevent"])},Object(n["toDisplayString"])(e.name),9,Mn))),128))])]),Object(n["createVNode"])(r,{to:{path:"/TeacherNewTB",query:{courseId:l.courseId}}},{default:Object(n["withCtx"])(()=>t[35]||(t[35]=[Object(n["createElementVNode"])("button",{class:"t_button"},"New Draft Pool",-1)])),_:1},8,["to"]),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[0]||(t[0]=(...e)=>a.importTest&&a.importTest(...e))},"Import Test"),Object(n["createElementVNode"])("div",Qn,[t[36]||(t[36]=Object(n["createElementVNode"])("button",{class:"t_dropbtn"},"Question Type",-1)),Object(n["createElementVNode"])("div",Pn,[Object(n["createElementVNode"])("a",{href:"#",onClick:t[1]||(t[1]=e=>a.selectQuestionType("True/False"))},"True/False"),Object(n["createElementVNode"])("a",{href:"#",onClick:t[2]||(t[2]=e=>a.selectQuestionType("Multiple Choice"))},"Multiple Choice"),Object(n["createElementVNode"])("a",{href:"#",onClick:t[3]||(t[3]=e=>a.selectQuestionType("Matching"))},"Matching"),Object(n["createElementVNode"])("a",{href:"#",onClick:t[4]||(t[4]=e=>a.selectQuestionType("Fill in the Blank"))},"Fill in the Blank"),Object(n["createElementVNode"])("a",{href:"#",onClick:t[5]||(t[5]=e=>a.selectQuestionType("Short Answer"))},"Short Answer"),Object(n["createElementVNode"])("a",{href:"#",onClick:t[6]||(t[6]=e=>a.selectQuestionType("Essay"))},"Essay")])]),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[7]||(t[7]=e=>l.showCourseEditPopup=!0)},"Edit Course Info"),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[8]||(t[8]=(...e)=>a.edit&&a.edit(...e))},"New Question"),Object(n["createVNode"])(r,{to:{name:"TeacherPubQ",query:{course_id:l.courseId,textbook_id:l.textbookId}}},{default:Object(n["withCtx"])(()=>t[37]||(t[37]=[Object(n["createElementVNode"])("button",{class:"t_button"},"Community Resources",-1)])),_:1},8,["to"]),Object(n["createElementVNode"])("div",Un,Object(n["toDisplayString"])(l.selectedQuestionType),1)]),t[38]||(t[38]=Object(n["createElementVNode"])("hr",null,null,-1))]),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.questions,(e,o)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:o,class:Object(n["normalizeClass"])(["question-box",{selected:l.selectedQuestionId===e.id}]),onClick:t=>a.toggleQuestionSelection(e.id)},[Object(n["createElementVNode"])("strong",null,"Question "+Object(n["toDisplayString"])(o+1)+":",1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.text),1),t[52]||(t[52]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[39]||(t[39]=Object(n["createElementVNode"])("strong",null,"Type:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.type),1)]),t[53]||(t[53]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[40]||(t[40]=Object(n["createElementVNode"])("strong",null,"Chapter:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.chapter||"N/A"),1)]),t[54]||(t[54]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[41]||(t[41]=Object(n["createElementVNode"])("strong",null,"Section:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.section||"N/A"),1)]),t[55]||(t[55]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[42]||(t[42]=Object(n["createElementVNode"])("strong",null,"Points:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.points),1)]),t[56]||(t[56]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[43]||(t[43]=Object(n["createElementVNode"])("strong",null,"Estimated Time:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.time)+" minutes",1)]),t[57]||(t[57]=Object(n["createElementVNode"])("br",null,null,-1)),"True/False"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",$n,[t[44]||(t[44]=Object(n["createElementVNode"])("strong",null,"Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.answer?"True":"False"),1)])):Object(n["createCommentVNode"])("",!0),"Multiple Choice"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",zn,[t[45]||(t[45]=Object(n["createElementVNode"])("strong",null,"Correct Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.correctOption&&e.correctOption.option_text||"Not specified"),1),t[46]||(t[46]=Object(n["createElementVNode"])("br",null,null,-1)),t[47]||(t[47]=Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("strong",null,"Other Options:")],-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.incorrectOptions,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t,class:"incorrect-answer"},Object(n["toDisplayString"])(e.option_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Fill in the Blank"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Hn,[t[48]||(t[48]=Object(n["createElementVNode"])("strong",null,"Correct Answer(s):",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.blanks,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.correct_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Matching"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Rn,[t[49]||(t[49]=Object(n["createElementVNode"])("strong",null,"Pairs:",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.pairs,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.term)+" - "+Object(n["toDisplayString"])(e.definition),1))),128))])])):Object(n["createCommentVNode"])("",!0),e.image_url?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Wn,[t[50]||(t[50]=Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("strong",null,"Attached Image:")],-1)),Object(n["createElementVNode"])("img",{src:e.image_url,alt:"Question Attachment:",style:{"max-width":"100%","max-height":"400px","margin-bottom":"10px"}},null,8,Gn)])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("span",null,[t[51]||(t[51]=Object(n["createElementVNode"])("strong",null,"Grading Instructions:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.instructions||"None"),1)]),t[58]||(t[58]=Object(n["createElementVNode"])("br",null,null,-1)),l.selectedQuestionId===e.id?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Jn,[Object(n["createElementVNode"])("button",{onClick:Object(n["withModifiers"])(t=>a.editQuestion(e),["stop"])},"Edit",8,Xn),Object(n["createElementVNode"])("button",{onClick:Object(n["withModifiers"])(t=>a.deleteQuestion(e.id),["stop"])},"Delete",8,Kn),Object(n["createElementVNode"])("button",{onClick:Object(n["withModifiers"])(t=>a.openAddToTestBank(e.id),["stop"])},"Add to Draft Pool",8,Yn)])):Object(n["createCommentVNode"])("",!0)],10,Ln))),128))]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",{class:"popup-overlay",onClick:t[10]||(t[10]=Object(n["withModifiers"])((...e)=>a.closeAddToTBModal&&a.closeAddToTBModal(...e),["self"]))},[Object(n["createElementVNode"])("div",Zn,[t[59]||(t[59]=Object(n["createElementVNode"])("h2",null,"Select draft pool to add question to:",-1)),Object(n["createElementVNode"])("div",ec,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.testBanks,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:e.testbank_id,style:{"margin-bottom":"10px",width:"100%"}},[Object(n["createElementVNode"])("button",{class:"t_button",style:{width:"100%"},onClick:t=>a.assignQuestionToTestBank(e.testbank_id)},Object(n["toDisplayString"])(e.name),9,tc)]))),128)),Object(n["createElementVNode"])("div",oc,[Object(n["createElementVNode"])("button",{type:"button",class:"btn cancel",style:{width:"100%"},onClick:t[9]||(t[9]=(...e)=>a.closeAddToTBModal&&a.closeAddToTBModal(...e))}," Close ")])])])],512),[[n["vShow"],l.showAddToTBModal]]),Object(n["createElementVNode"])("input",{type:"file",id:"fileInput",style:{display:"none"},onChange:t[11]||(t[11]=(...e)=>a.handleFileUpload&&a.handleFileUpload(...e))},null,32),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",{class:"popup-overlay",onClick:t[27]||(t[27]=Object(n["withModifiers"])((...e)=>a.closeForm&&a.closeForm(...e),["self"]))},[Object(n["createElementVNode"])("div",nc,[Object(n["createElementVNode"])("form",{class:"form-container",onSubmit:t[26]||(t[26]=Object(n["withModifiers"])((...e)=>a.handleQuestionSave&&a.handleQuestionSave(...e),["prevent"]))},[Object(n["createElementVNode"])("h1",null,Object(n["toDisplayString"])(l.editingQuestionId?"Edit Question":"New Question"),1),t[69]||(t[69]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Chapter Number")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[12]||(t[12]=e=>l.chapter=e),required:""},null,512),[[n["vModelText"],l.chapter]]),t[70]||(t[70]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Section Number")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[13]||(t[13]=e=>l.section=e),required:""},null,512),[[n["vModelText"],l.section]]),t[71]||(t[71]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Question Type"),Object(n["createElementVNode"])("br")],-1)),l.editingQuestionId?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",lc,[Object(n["createElementVNode"])("input",{type:"text",value:l.selectedQuestionType,disabled:""},null,8,ac)])):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",cc,[Object(n["withDirectives"])(Object(n["createElementVNode"])("select",{"onUpdate:modelValue":t[14]||(t[14]=e=>l.selectedQuestionType=e),required:""},t[60]||(t[60]=[Object(n["createElementVNode"])("option",{disabled:"",value:""},"Select a type",-1),Object(n["createElementVNode"])("option",null,"True/False",-1),Object(n["createElementVNode"])("option",null,"Multiple Choice",-1),Object(n["createElementVNode"])("option",null,"Matching",-1),Object(n["createElementVNode"])("option",null,"Fill in the Blank",-1),Object(n["createElementVNode"])("option",null,"Short Answer",-1),Object(n["createElementVNode"])("option",null,"Essay",-1)]),512),[[n["vModelSelect"],l.selectedQuestionType]])])),t[72]||(t[72]=Object(n["createElementVNode"])("br",null,null,-1)),t[73]||(t[73]=Object(n["createElementVNode"])("br",null,null,-1)),t[74]||(t[74]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Question Text")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[15]||(t[15]=e=>l.question=e),required:""},null,512),[[n["vModelText"],l.question]]),"True/False"===l.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",rc,[t[62]||(t[62]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Answer")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("select",{"onUpdate:modelValue":t[16]||(t[16]=e=>l.answer=e)},t[61]||(t[61]=[Object(n["createElementVNode"])("option",{value:"True"},"True",-1),Object(n["createElementVNode"])("option",{value:"False"},"False",-1)]),512),[[n["vModelSelect"],l.answer]])])):Object(n["createCommentVNode"])("",!0),"Multiple Choice"===l.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",sc,[t[63]||(t[63]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Correct Answer")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[17]||(t[17]=e=>l.answer=e)},null,512),[[n["vModelText"],l.answer]]),t[64]||(t[64]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Incorrect Answer Choices (comma-separated)")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[18]||(t[18]=e=>l.answerChoices=e)},null,512),[[n["vModelText"],l.answerChoices]])])):Object(n["createCommentVNode"])("",!0),"Matching"===l.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",ic,[t[65]||(t[65]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Matching Pairs")],-1)),(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.matchingPairs,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:t},[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t=>e.term=t,placeholder:"Term"},null,8,dc),[[n["vModelText"],e.term]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t=>e.definition=t,placeholder:"Definition"},null,8,bc),[[n["vModelText"],e.definition]]),Object(n["createElementVNode"])("button",{type:"button",onClick:e=>a.removePair(t)},"Remove",8,uc)]))),128)),Object(n["createElementVNode"])("button",{type:"button",onClick:t[19]||(t[19]=(...e)=>a.addPair&&a.addPair(...e))},"Add Pair")])):Object(n["createCommentVNode"])("",!0),"Fill in the Blank"===l.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",mc,[t[66]||(t[66]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Correct Answer")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[20]||(t[20]=e=>l.answer=e)},null,512),[[n["vModelText"],l.answer]])])):Object(n["createCommentVNode"])("",!0),"Essay"===l.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",pc)):Object(n["createCommentVNode"])("",!0),t[75]||(t[75]=Object(n["createElementVNode"])("br",null,null,-1)),t[76]||(t[76]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Points Worth")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[21]||(t[21]=e=>l.points=e),required:""},null,512),[[n["vModelText"],l.points]]),t[77]||(t[77]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Estimated Time (in minutes)")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[22]||(t[22]=e=>l.time=e),required:""},null,512),[[n["vModelText"],l.time]]),t[78]||(t[78]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Grading Instructions")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[23]||(t[23]=e=>l.instructions=e),required:""},null,512),[[n["vModelText"],l.instructions]]),l.editingQuestionId?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Oc,[t[67]||(t[67]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Upload Image")],-1)),Object(n["createElementVNode"])("input",{type:"file",onChange:t[24]||(t[24]=(...e)=>a.handleImageUpload&&a.handleImageUpload(...e)),accept:"image/*"},null,32),l.imagePreview?(Object(n["openBlock"])(),Object(n["createElementBlock"])("img",{key:0,src:l.imagePreview,alt:"Preview",style:{"max-width":"100%"}},null,8,hc)):Object(n["createCommentVNode"])("",!0)])),l.editingQuestionId&&l.imagePreview?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",jc,[t[68]||(t[68]=Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("strong",null,"Attached Image:")],-1)),Object(n["createElementVNode"])("img",{src:l.imagePreview,alt:"Attached Image",style:{"max-width":"100%","max-height":"300px","margin-bottom":"10px"}},null,8,kc)])):Object(n["createCommentVNode"])("",!0),t[79]||(t[79]=Object(n["createElementVNode"])("br",null,null,-1)),t[80]||(t[80]=Object(n["createElementVNode"])("br",null,null,-1)),t[81]||(t[81]=Object(n["createElementVNode"])("button",{type:"submit",class:"btn"},"Save",-1)),Object(n["createElementVNode"])("button",{type:"button",class:"btn cancel",onClick:t[25]||(t[25]=(...e)=>a.closeForm&&a.closeForm(...e))},"Close")],32)])],512),[[n["vShow"],l.showForm]]),l.showCourseEditPopup?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:0,class:"popup-overlay",onClick:t[32]||(t[32]=Object(n["withModifiers"])(e=>l.showCourseEditPopup=!1,["self"]))},[Object(n["createElementVNode"])("div",Nc,[Object(n["createElementVNode"])("form",{class:"form-container",onSubmit:t[31]||(t[31]=Object(n["withModifiers"])((...e)=>a.saveCourseInfo&&a.saveCourseInfo(...e),["prevent"]))},[t[82]||(t[82]=Object(n["createElementVNode"])("h1",null,"Edit Course Info",-1)),t[83]||(t[83]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Course Title")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[28]||(t[28]=e=>l.editCourseTitle=e),required:""},null,512),[[n["vModelText"],l.editCourseTitle]]),t[84]||(t[84]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Course Number")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[29]||(t[29]=e=>l.editCourseNumber=e),required:""},null,512),[[n["vModelText"],l.editCourseNumber]]),t[85]||(t[85]=Object(n["createElementVNode"])("br",null,null,-1)),t[86]||(t[86]=Object(n["createElementVNode"])("button",{type:"submit",class:"btn"},"Save",-1)),Object(n["createElementVNode"])("button",{type:"button",class:"btn cancel",onClick:t[30]||(t[30]=e=>l.showCourseEditPopup=!1)},"Cancel")],32)])])):Object(n["createCommentVNode"])("",!0)])}var Ec={name:"TeacherQuestions",data(){return{courseTitle:this.$route.query.courseTitle||"Untitled Course",courseId:this.$route.query.courseId||null,textbookId:this.$route.query.textbook_id,chapter:"",section:"",question:"",reference:"",answer:"",answerChoices:"",points:"",time:"",instructions:"",image:"",imagePreview:"",selectedQuestionType:"",matchingPairs:[],questions:[],selectedQuestionId:null,editingQuestionId:null,showForm:!1,selectedTestbank:null,testBanks:[],showCourseEditPopup:!1,editCourseTitle:this.$route.query.courseTitle||"",editCourseNumber:"",showAddToTBModal:!1,questionToAddToTB:null,oldMCOptionIds:[]}},mounted(){const e=this.$route.params.id;console.log("Viewing testbank:",e),this.loadTestbanks(),this.$route.query.testBankName&&(this.selectedTestBank={name:this.$route.query.testBankName})},methods:{openAddToTestBank(e){this.questionToAddToTB=e,this.showAddToTBModal=!0},closeAddToTBModal(){this.questionToAddToTB=null,this.showAddToTBModal=!1},async assignQuestionToTestBank(e){if(this.questionToAddToTB)try{await F.post(`/testbanks/${e}/questions`,{question_ids:[this.questionToAddToTB]},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),alert("Question successfully added to testbank!"),this.closeAddToTBModal()}catch(t){console.error("Failed to add question to testbank:",t),alert("Failed to add question.")}},openCourseEditPopup(){const e=this.courseTitle.trim().split(" ");this.editCourseNumber=e.length>1?e.pop():"",this.editCourseTitle=e.join(" "),this.showCourseEditPopup=!0},async saveCourseInfo(){try{await F.patch("/courses/"+this.courseId,{course_name:this.editCourseTitle,course_number:this.editCourseNumber},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});const e=`${this.editCourseTitle} ${this.editCourseNumber}`.trim();this.courseTitle=e,document.title=e,this.showCourseEditPopup=!1,alert("Course info updated successfully.")}catch(e){console.error("Failed to update course:",e),alert("Failed to update course.")}},async loadTestbanks(){try{const e=await F.get("/testbanks/teacher?course_id="+this.courseId,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.testBanks=e.data.testbanks}catch(e){console.error("Failed to load teacher testbanks:",e)}},selectTestBank(e){this.selectedTestBank=e,this.selectedTestbankId=e.value,this.$router.push({name:"TeacherViewTB",params:{id:e.testbank_id},query:{courseId:this.courseId,courseTitle:this.courseTitle,testBankName:e.name}})},async fetchQuestions(e){this.selectedQuestionType=e;try{const t=await F.get("/questions",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{course_id:this.$route.query.courseId,type:e}});console.log("Questions fetched:",t.data),Array.isArray(t.data.questions)?this.questions=t.data.questions.map(e=>{const t={text:e.question_text,type:e.type,points:e.default_points,id:e.id,instructions:e.grading_instructions||"",time:e.est_time,chapter:e.chapter_number,section:e.section_number,image_url:e.attachment&&e.attachment.url?e.attachment.url:""};switch(e.type){case"True/False":return{...t,answer:e.true_false_answer};case"Multiple Choice":return{...t,correctOption:e.correct_option||null,incorrectOptions:e.incorrect_options||[]};case"Matching":return{...t,pairs:(e.matches||[]).map(e=>({match_id:e.match_id,term:e.prompt_text,definition:e.match_text}))};case"Fill in the Blank":return{...t,blanks:e.blanks||[],instructions:e.grading_instructions||""};case"Short Answer":return{...t,answer:e.answer||""};case"Essay":return{...t,instructions:e.instructions||""};default:return t}}):this.questions=[]}catch(t){console.error("Error fetching questions:",t),this.questions=[]}},displayQuestionType(e){this.selectedQuestionType="Selected Question Type: "+e},created(){console.log("Query Parameters:",this.$route.query)},importTest(){document.getElementById("fileInput").click()},async handleFileUpload(e){const t=e.target.files[0];if(!t)return void alert("No file selected.");const o=new FormData;o.append("file",t);try{const e=await F.post("/qti/upload",o,{headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"multipart/form-data"}}),t=e.data.file_path;console.log("File uploaded successfully:",t);const n=await F.post("/qti/import",{file_path:t},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),c=n.data.import_id;console.log("QTI import created. Import ID:",c);const l=await F.post("qti/save/"+c,{course_id:this.courseId},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});alert(l.data.message||"Questions imported successfully!"),console.log("Questions imported successfully:",l.data),this.fetchQuestions(this.selectedQuestionType)}catch(n){console.error("QTI import Failed:",n),alert("Failed to upload file. Please try again.")}},async handleQuestionSave(){try{let e,t;const o=this.questions.find(e=>e.id===this.editingQuestionId),n=!!this.editingQuestionId,c={question_text:this.question,default_points:parseInt(this.points),est_time:parseInt(this.time),chapter_number:this.chapter,section_number:this.section,grading_instructions:this.instructions,type:this.selectedQuestionType,source:"manual",course_id:this.courseId};let l=[];if("Multiple Choice"===this.selectedQuestionType){const e=this.answerChoices.split(",").map(e=>e.trim()).filter(Boolean),t=this.answer.trim();if(!t)return void alert("Correct answer cannot be empty.");if(l.push({option_text:t,is_correct:!0}),e.forEach(e=>{l.push({option_text:e,is_correct:!1})}),!l.some(e=>e.is_correct))return void alert("Multiple Choice questions must have at least one correct answer.")}if(this.image){e=new FormData,e.append("file",this.image);for(const[t,o]of Object.entries(c))e.append(t,o);switch(this.selectedQuestionType){case"True/False":e.append("true_false_answer","True"===this.answer);break;case"Multiple Choice":e.append("options",JSON.stringify(l)),n&&this.oldMCOptionIds.length>0&&e.append("to_delete",JSON.stringify(this.oldMCOptionIds));break;case"Matching":if(e.append("matches",JSON.stringify(this.matchingPairs.map(e=>({prompt_text:e.term,match_text:e.definition})))),n&&o){const t=(o.pairs||[]).map(e=>e.match_id);e.append("to_delete",JSON.stringify(t))}break;case"Fill in the Blank":if(e.append("blanks",JSON.stringify([{correct_text:this.answer}])),n&&o){const t=(o.blanks||[]).map(e=>e.blank_id);e.append("to_delete",JSON.stringify(t))}break;case"Short Answer":e.append("answer",this.answer);break;case"Essay":e.append("grading_instructions",this.instructions);break}t={headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"multipart/form-data"}}}else{switch(e={...c},this.selectedQuestionType){case"True/False":e.true_false_answer="True"===this.answer;break;case"Multiple Choice":e.options=l,n&&this.oldMCOptionIds.length>0&&(e.to_delete=this.oldMCOptionIds);break;case"Matching":if(e.matches=this.matchingPairs.map(e=>({prompt_text:e.term,match_text:e.definition})),n&&o){const t=(o.pairs||[]).map(e=>e.match_id);e.to_delete=t}break;case"Fill in the Blank":if(e.blanks=[{correct_text:this.answer}],n&&o){const t=(o.blanks||[]).map(e=>e.blank_id);e.to_delete=t}break;case"Short Answer":e.answer=this.answer;break;case"Essay":e.grading_instructions=this.instructions;break}t={headers:{Authorization:"Bearer "+localStorage.getItem("token")}}}n?await F.patch("/questions/"+this.editingQuestionId,e,t):await F.post("/questions",e,t),alert("Question saved successfully!"),this.closeForm(),this.resetForm(),this.fetchQuestions(this.selectedQuestionType)}catch(e){let t="Something went wrong.";e&&e.response&&e.response.data&&(t=e.response.data.error||e.response.data.message||t),alert("Save failed: "+t),console.error("Error saving question:",e)}},selectQuestionType(e){this.selectedQuestionType="Selected Question Type: "+e,this.fetchQuestions(e)},edit(){this.resetForm(),this.showForm=!0},closeForm(){this.showForm=!1},addPair(){this.matchingPairs.push({term:"",definition:""})},removePair(e){this.matchingPairs.splice(e,1)},handleImageUpload(e){const t=e.target.files[0];if(t){this.image=t;const e=new FileReader;e.onload=e=>{this.imagePreview=e.target.result},e.readAsDataURL(t)}},resetForm(){this.chapter="",this.section="",this.question="",this.reference="",this.answer="",this.answerChoices="",this.points="",this.time="",this.instructions="",this.image="",this.imagePreview="",this.matchingPairs=[],this.selectedQuestionType="",this.editingQuestionId=null,this.image="",this.imagePreview=""},editQuestion(e){this.editingQuestionId=e.id,this.question=e.text,this.chapter=e.chapter,this.section=e.section,this.points=e.points,this.time=e.time,this.instructions=e.instructions,this.answer=e.answer||"",this.selectedQuestionType=e.type,"Multiple Choice"===e.type?(this.answer=e.correctOption&&e.correctOption.option_text||"",this.answerChoices=(e.incorrectOptions||[]).map(e=>e.option_text).join(", "),this.oldMCOptionIds=[],e.correctOption&&e.correctOption.option_id&&this.oldMCOptionIds.push(e.correctOption.option_id),Array.isArray(e.incorrectOptions)&&e.incorrectOptions.forEach(e=>{e.option_id&&this.oldMCOptionIds.push(e.option_id)})):"Matching"===e.type&&(this.matchingPairs=(e.pairs||[]).map(e=>({term:e.term,definition:e.definition}))),this.imagePreview=e.image_url||"",this.image=null,this.showForm=!0;const t=document.getElementById("q_edit");t&&t.style&&(t.style.display="block")},toggleQuestionSelection(e){this.selectedQuestionId=this.selectedQuestionId===e?null:e},async deleteQuestion(e){if(confirm("Are you sure you want to delete this question?"))try{await F.delete("/questions/"+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),this.questions=this.questions.filter(t=>t.id!==e),alert("Question deleted.")}catch(t){console.error(t),alert("Failed to delete question.")}}}};o("b4e7");const Vc=s()(Ec,[["render",gc],["__scopeId","data-v-4c6aabfd"]]);var yc=Vc;const wc={class:"theme-teacher"},fc={class:"top-banner"},Tc={class:"banner-title"},vc={class:"t_banner-actions"},Bc={class:"button-row"},_c={class:"export-note"},xc={class:"export-note"},Cc={class:"form-popup-modal"},Sc={class:"form-container"},Fc={style:{display:"flex","justify-content":"center",gap:"10px","margin-top":"20px"}},Dc={class:"question-list-container"},Ic={class:"question-box"},qc={class:"drag-header"},Ac={key:0},Mc={type:"A"},Qc={class:"question-type-label"},Pc={key:1},Uc={class:"correct-answer-display"},Lc={class:"question-type-label"},$c={key:2},zc={class:"matching-container"},Hc={class:"matching-prompts"},Rc={class:"matching-answers"},Wc={class:"matching-footer"},Gc={class:"correct-answer-display"},Jc={class:"question-type-label"},Xc={key:3},Kc={class:"correct-answer-display"},Yc={class:"question-type-label"},Zc={key:4},el={class:"correct-answer-display"},tl={class:"question-type-label"},ol={key:5};function nl(e,t,o,c,l,a){const r=Object(n["resolveComponent"])("router-link"),s=Object(n["resolveComponent"])("draggable");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",wc,[Object(n["createElementVNode"])("div",fc,[Object(n["createElementVNode"])("div",Tc,Object(n["toDisplayString"])(l.testOptions.testName||"Test Template"),1),Object(n["createElementVNode"])("div",vc,[Object(n["createVNode"])(r,{to:"/TeacherHome",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[7]||(t[7]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[8]||(t[8]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",Bc,[Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[0]||(t[0]=(...t)=>e.publishTest&&e.publishTest(...t))},"Publish Final Test"),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[1]||(t[1]=e=>l.showBackWarning=!0)},"Back to Draft Pool"),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[2]||(t[2]=(...e)=>a.exportToWord&&a.exportToWord(...e))},"Export Test to Document")]),t[20]||(t[20]=Object(n["createElementVNode"])("p",{class:"export-note"},[Object(n["createElementVNode"])("strong",null,"Note:"),Object(n["createTextVNode"])(" Anything displayed in "),Object(n["createElementVNode"])("span",{class:"green-text"},"green"),Object(n["createTextVNode"])(" will not appear on the student test but will be included in the test key. "),Object(n["createElementVNode"])("br"),Object(n["createTextVNode"])(" If selected, a cover page and any uploaded graphic will be added automatically to the exported document. ")],-1)),Object(n["createElementVNode"])("p",_c,[t[9]||(t[9]=Object(n["createElementVNode"])("strong",null,"Total Test Time:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(a.totalEstimatedTime)+" minutes ",1)]),Object(n["createElementVNode"])("p",xc,[t[10]||(t[10]=Object(n["createElementVNode"])("strong",null,"Total Points:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(this.questions.length)+" points ",1)]),t[21]||(t[21]=Object(n["createElementVNode"])("hr",null,null,-1)),l.showBackWarning?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:0,class:"popup-overlay",onClick:t[5]||(t[5]=Object(n["withModifiers"])(e=>l.showBackWarning=!1,["self"]))},[Object(n["createElementVNode"])("div",Cc,[Object(n["createElementVNode"])("div",Sc,[t[11]||(t[11]=Object(n["createElementVNode"])("h2",{style:{"text-align":"center"}},"Warning",-1)),t[12]||(t[12]=Object(n["createElementVNode"])("p",{style:{"text-align":"center","font-size":"18px"}}," If you go back to the Draft Pool, any unsaved changes on this page may be lost. ",-1)),Object(n["createElementVNode"])("div",Fc,[Object(n["createElementVNode"])("button",{class:"btn",onClick:t[3]||(t[3]=(...e)=>a.confirmBack&&a.confirmBack(...e))},"Continue"),Object(n["createElementVNode"])("button",{class:"btn cancel",onClick:t[4]||(t[4]=e=>l.showBackWarning=!1)},"Cancel")])])])])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",Dc,[Object(n["createVNode"])(s,{modelValue:l.questions,"onUpdate:modelValue":t[6]||(t[6]=e=>l.questions=e),"item-key":"id",class:"drag-list",handle:".drag-handle",onUpdate:a.saveOrder},{header:Object(n["withCtx"])(()=>t[13]||(t[13]=[])),item:Object(n["withCtx"])(({element:e,index:o})=>[Object(n["createElementVNode"])("div",Ic,[Object(n["createElementVNode"])("div",qc,[t[14]||(t[14]=Object(n["createElementVNode"])("span",{class:"drag-handle",title:"Drag to reorder"},"✥",-1)),Object(n["createElementVNode"])("h3",null,Object(n["toDisplayString"])(o+1)+". "+Object(n["toDisplayString"])(e.question_text),1)]),"Multiple Choice"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Ac,[Object(n["createElementVNode"])("ol",Mc,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(a.shuffleOptions(e),(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:e.option_id||t,class:Object(n["normalizeClass"])({"correct-answer":e.is_correct})},Object(n["toDisplayString"])(e.option_text),3))),128))]),Object(n["createElementVNode"])("div",Qc,Object(n["toDisplayString"])(e.type),1)])):"Fill in the Blank"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Pc,[t[15]||(t[15]=Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("strong",null,"Answer:"),Object(n["createTextVNode"])(" __________________________")],-1)),Object(n["createElementVNode"])("p",Uc," Correct Answer: "+Object(n["toDisplayString"])(e.blanks.map(e=>e.correct_text).join(", ")),1),Object(n["createElementVNode"])("div",Lc,Object(n["toDisplayString"])(e.type),1)])):"Matching"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",$c,[Object(n["createElementVNode"])("div",zc,[Object(n["createElementVNode"])("div",Hc,[t[16]||(t[16]=Object(n["createElementVNode"])("h4",null,"Match the following:",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(a.getShuffledMatches(e),(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(t+1)+". "+Object(n["toDisplayString"])(e.prompt_text),1))),128))])]),Object(n["createElementVNode"])("div",Rc,[t[17]||(t[17]=Object(n["createElementVNode"])("h4",null,"Answer Bank:",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(a.getShuffledAnswerBank(e),(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(String.fromCharCode(65+t))+". "+Object(n["toDisplayString"])(e),1))),128))])])]),Object(n["createElementVNode"])("div",Wc,[Object(n["createElementVNode"])("p",Gc," Correct Matches: "+Object(n["toDisplayString"])(a.getMatchingKeyString(e)),1),Object(n["createElementVNode"])("div",Jc,Object(n["toDisplayString"])(e.type),1)])])):"True/False"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Xc,[t[18]||(t[18]=Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("strong",null,"Answer:"),Object(n["createTextVNode"])(" __________________________")],-1)),Object(n["createElementVNode"])("p",Kc," Correct Answer: "+Object(n["toDisplayString"])(e.true_false_answer?"True":"False"),1),Object(n["createElementVNode"])("div",Yc,Object(n["toDisplayString"])(e.type),1)])):"Short Answer"===e.type||"Essay"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Zc,[Object(n["createElementVNode"])("p",el," Grading Instructions: "+Object(n["toDisplayString"])(e.grading_instructions||"None provided"),1),Object(n["createElementVNode"])("div",tl,Object(n["toDisplayString"])(e.type),1)])):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",ol,[Object(n["createElementVNode"])("em",null,"Type: "+Object(n["toDisplayString"])(e.type),1)]))])]),footer:Object(n["withCtx"])(()=>t[19]||(t[19]=[])),_:1},8,["modelValue","onUpdate"])])])}var cl=o("b76a"),ll=o.n(cl),al=o("21a6"),rl={components:{draggable:ll.a},data(){const e=JSON.parse(localStorage.getItem("testOptions")||"{}");return{questions:[],testOptions:{testName:e.testName||this.$route.query.testBankName||"Test Template",coverPage:e.coverPage||!1,selectedTemplate:e.selectedTemplate||"All Questions",uploadedImage:e.uploadedImage||"",graphicPreview:e.graphicPreview||""},testBankId:this.$route.query.testBankId,showBackWarning:!1,hasUnsavedChanges:!0}},mounted(){this.fetchQuestions(),window.addEventListener("beforeunload",this.confirmExit)},beforeDestroy(){window.removeEventListener("beforeunload",this.confirmExit)},watch:{questions:{deep:!0,handler(e){const t=e.map(e=>e.id);localStorage.setItem("questionOrder_"+this.testBankId,JSON.stringify(t))}}},computed:{totalEstimatedTime(){return this.questions.reduce((e,t)=>{const o=parseInt(t.est_time,10);return e+(isNaN(o)?0:o)},0)}},methods:{confirmExit(e){this.hasUnsavedChanges&&(e.preventDefault(),e.returnValue="")},confirmBack(){this.showBackWarning=!1,this.goBackTB()},goBackTB(){this.$router.push({name:"TeacherViewTB",params:{id:this.testBankId},query:{courseId:this.$route.query.courseId,courseTitle:this.$route.query.courseTitle,testBankName:this.$route.query.testBankName}})},async fetchQuestions(){try{const e=await F.get("/tests/draft-questions",{params:{test_bank_id:this.testBankId,type:this.testOptions.selectedTemplate||"All Questions"},headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),t=e.data.questions||[],o=localStorage.getItem("questionOrder_"+this.testBankId);if(o){const e=JSON.parse(o),n=new Map(t.map(e=>[e.id,e])),c=e.map(e=>n.get(e)).filter(Boolean);t.forEach(t=>{e.includes(t.id)||c.push(t)}),this.questions=c}else this.questions=t}catch(e){console.error("Failed to fetch questions:",e)}},saveOrder(){const e=this.questions.map(e=>e.id);localStorage.setItem("questionOrder_"+this.testBankId,JSON.stringify(e))},shuffleOptions(e){const t=[...e.incorrect_options,e.correct_option].map(e=>({...e,is_correct:!!e.is_correct}));for(let o=t.length-1;o>0;o--){const e=Math.floor(Math.random()*(o+1));[t[o],t[e]]=[t[e],t[o]]}return t},shuffleArray(e){const t=[...e];for(let o=t.length-1;o>0;o--){const e=Math.floor(Math.random()*(o+1));[t[o],t[e]]=[t[e],t[o]]}return t},getShuffledBlanks(e){return this.shuffleArray(e.blanks||[])},getShuffledMatches(e){const t=e.matches||[],o=t.map(e=>e.prompt_text),n=this.getShuffledAnswerBank(e);return o.map((e,t)=>({prompt_text:e,match_text:n[t]}))},getShuffledAnswerBank(e){if(!e._shuffledAnswers){const t=e.matches||[],o=this.shuffleArray(t.map(e=>e.match_text));e._shuffledAnswers=o}return e._shuffledAnswers},getMatchingKeyString(e){const t=this.getShuffledAnswerBank(e);return(e.matches||[]).map((e,o)=>{const n=t.findIndex(t=>t===e.match_text);return`${o+1} → ${String.fromCharCode(65+n)}`}).join(", ")},async exportToWord(){const{Document:e,Packer:t,Paragraph:n,TextRun:c,ImageRun:l,Table:a,TableRow:r,TableCell:s,HeadingLevel:i,AlignmentType:d,BorderStyle:b,ThematicBreak:u,WidthType:m}=await o.e("chunk-2d0d6e77").then(o.bind(null,"7514")),p=()=>new n(new u),O=new n({children:[],pageBreakBefore:!0}),h=()=>{const e=[new n({text:this.testOptions.testName,heading:i.TITLE,alignment:d.CENTER,spacing:{after:200}}),new n({text:"Version: XXXX",heading:i.HEADING_1,alignment:d.CENTER,spacing:{after:200}}),new n({text:"Name: __________________________",spacing:{after:400}}),new n({text:"Date: __________________________",spacing:{after:400}}),new n({text:"Course: "+(this.$route.query.courseTitle||"N/A")}),new n({text:"Time Allowed: "+(this.totalEstimatedTime||"N/A")+" minutes",spacing:{after:400}}),p(),new n({text:"Instructions:",heading:i.HEADING_2,spacing:{after:100}}),...[`This exam is worth ${this.questions.length} points.`,`You have ${this.totalEstimatedTime||"N/A"} minutes to complete the exam.`,"Read each question carefully.","Be sure to answer all questions, do not leave anything blank.","Turn in all work and scratch paper with your exam.","You may not use any external materials unless permitted by the instructor.","This exam is closed-book, closed-notes, and no external devices or help.","Check your work before submitting."].map(e=>new n({text:e,bullet:{level:0},spacing:{after:100}})),O];return e},j=()=>{const e=[new n({text:this.testOptions.testName+" - Version: XXXX",heading:i.HEADING_1,spacing:{after:300}}),new n({text:"Name: __________________________",spacing:{after:400}}),p()];return this.questions.forEach((t,o)=>{if(e.push(new n({text:`${o+1}. ${t.question_text}`,spacing:{after:200}})),"Multiple Choice"===t.type){const o=this.shuffleOptions(t);o.forEach((t,o)=>{e.push(new n({text:`${String.fromCharCode(65+o)}. ${t.option_text}`,indent:{left:720},spacing:{after:100}}))})}else if("True/False"===t.type)e.push(new n("True/False: __________________________"));else if("Fill in the Blank"===t.type)e.push(new n("Blank: _____________________"));else if("Short Answer"===t.type)for(let c=0;c<15;c++)e.push(new n(" "));else if("Essay"===t.type)for(let c=0;c<30;c++)e.push(new n(" "));else if("Matching"===t.type){e.push(new n({spacing:{after:200}}));const o=this.getShuffledMatches(t),c=(this.getShuffledAnswerBank(t),o.map((e,t)=>{const o=`${t+1}. ${e.prompt_text}`,c=`${String.fromCharCode(65+t)}. ${e.match_text}`;return new r({children:[new s({width:{size:50,type:m.PERCENTAGE},children:[new n({text:o,spacing:{after:150}})],margins:{top:100,bottom:100}}),new s({width:{size:50,type:m.PERCENTAGE},children:[new n({text:c,spacing:{after:150}})],margins:{top:100,bottom:100}})]})}));e.push(new a({rows:c,width:{size:100,type:m.PERCENTAGE},borders:{top:{style:b.NONE,size:0,color:"FFFFFF"},bottom:{style:b.NONE,size:0,color:"FFFFFF"},left:{style:b.NONE,size:0,color:"FFFFFF"},right:{style:b.NONE,size:0,color:"FFFFFF"},insideHorizontal:{style:b.NONE,size:0,color:"FFFFFF"},insideVertical:{style:b.NONE,size:0,color:"FFFFFF"}}})),e.push(new n({text:" ",spacing:{after:300}}))}e.push(new n({text:" ",spacing:{after:300}}))}),e},k=()=>{const e=[new n({children:[new c({text:this.testOptions.testName+" - Test Key",bold:!0,size:32,color:"FF0000"})],spacing:{after:300}})];return this.questions.forEach((t,o)=>{let l="";if("Multiple Choice"===t.type){const e=this.shuffleOptions(t),o=e.findIndex(e=>e.is_correct);l=`Correct Answer: ${String.fromCharCode(65+o)}. ${e[o].option_text}`}else"True/False"===t.type?l="Correct Answer: "+(t.true_false_answer?"True":"False"):"Fill in the Blank"===t.type?l="Correct Answer: "+t.blanks.map(e=>e.correct_text).join(", "):"Short Answer"===t.type||"Essay"===t.type?l="Grading Instructions: "+(t.grading_instructions||"None"):"Matching"===t.type&&(l="Correct Matches: "+this.getMatchingKeyString(t));e.push(new n({text:`${o+1}. ${t.question_text}`,spacing:{after:100}}),new n({children:[new c({text:l,color:"FF0000"})],spacing:{after:300}}))}),e},N=async()=>{const e=[];if(this.testOptions.graphicPreview)try{const t=this.testOptions.graphicPreview.split(",")[1],o=window.atob(t),c=new Uint8Array(o.length);for(let e=0;e<o.length;e++)c[e]=o.charCodeAt(e);e.push(new n({children:[],pageBreakBefore:!0}),new n({text:"Resource Page",heading:i.HEADING_1,spacing:{after:300}}),new n({children:[new l({data:c,transformation:{width:500,height:300}})],spacing:{after:300}}))}catch(t){console.error("⚠ Failed to load image for resource page:",t),e.push(new n("⚠ Could not load the uploaded image."))}return e},g=await N(),E=new e({sections:[{properties:{},children:[...h(),...j(),...g]}],styles:{default:{document:{run:{font:"Arial",size:24}}}}}),V=new e({sections:[{properties:{},children:k()}],styles:{default:{document:{run:{font:"Arial",size:24}}}}}),[y,w]=await Promise.all([t.toBlob(E),t.toBlob(V)]);Object(al["saveAs"])(y,(this.testOptions.testName||"GeneratedTest")+".docx"),Object(al["saveAs"])(w,(this.testOptions.testName||"TestKey")+".key.docx")}}};o("48ef");const sl=s()(rl,[["render",nl],["__scopeId","data-v-158c83ea"]]);var il=sl;const dl={class:"theme-teacher"},bl={class:"top-banner"},ul={class:"banner-title"},ml={class:"t_banner-actions"},pl={class:"center large-paragraph",style:{color:"#222"}},Ol={class:"button-row"},hl={key:0,class:"popup-overlay"},jl={class:"form-popup-modal"},kl={class:"form-popup-modal"},Nl={class:"checkbox-label"},gl={class:"button-group"},El={key:0,style:{"margin-top":"10px"}},Vl=["src"],yl=["onClick"],wl={key:0},fl={key:1},Tl={key:2},vl={key:3},Bl={key:4},_l={key:5},xl={key:6,class:"button-group"},Cl=["onClick"];function Sl(e,t,o,c,l,a){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",dl,[Object(n["createElementVNode"])("div",bl,[Object(n["createElementVNode"])("div",ul,"Test Draft: "+Object(n["toDisplayString"])(l.testBankName),1),Object(n["createElementVNode"])("div",ml,[Object(n["createVNode"])(r,{to:"/TeacherHome",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[17]||(t[17]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[18]||(t[18]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",pl,[Object(n["createVNode"])(r,{to:{path:"/TeacherQuestions",query:{courseTitle:l.courseTitle,courseId:l.courseId}}},{default:Object(n["withCtx"])(()=>t[19]||(t[19]=[Object(n["createElementVNode"])("button",{class:"t_button"},"Return to Question Page",-1)])),_:1},8,["to"]),t[52]||(t[52]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("div",Ol,[Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[0]||(t[0]=e=>l.showEditForm=!0)},"Edit Draft Pool Info"),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[1]||(t[1]=e=>l.showCreateTestWarning=!0)},"Create New Test"),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[2]||(t[2]=(...e)=>a.viewPrevious&&a.viewPrevious(...e))},"View Previous Tests"),t[20]||(t[20]=Object(n["createElementVNode"])("br",null,null,-1))]),t[53]||(t[53]=Object(n["createElementVNode"])("hr",null,null,-1)),l.showEditForm?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",hl,[Object(n["createElementVNode"])("div",jl,[Object(n["createElementVNode"])("form",{class:"form-container",onSubmit:t[7]||(t[7]=Object(n["withModifiers"])((...e)=>a.updateTestBank&&a.updateTestBank(...e),["prevent"]))},[t[21]||(t[21]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("strong",null,"Draft Pool Name:")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>l.editForm.name=e),required:""},null,512),[[n["vModelText"],l.editForm.name]]),t[22]||(t[22]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("strong",null,"Chapter Number:")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>l.editForm.chapter=e),required:""},null,512),[[n["vModelText"],l.editForm.chapter]]),t[23]||(t[23]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("strong",null,"Section Number:")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=e=>l.editForm.section=e),required:""},null,512),[[n["vModelText"],l.editForm.section]]),t[24]||(t[24]=Object(n["createElementVNode"])("button",{type:"submit",class:"btn"},"Save Changes",-1)),Object(n["createElementVNode"])("button",{type:"button",class:"btn cancel",onClick:t[6]||(t[6]=e=>l.showEditForm=!1)},"Cancel")],32)])])):Object(n["createCommentVNode"])("",!0),l.showCreateTestWarning?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:1,class:"popup-overlay",onClick:t[16]||(t[16]=Object(n["withModifiers"])(e=>l.showCreateTestWarning=!1,["self"]))},[Object(n["createElementVNode"])("div",kl,[Object(n["createElementVNode"])("form",{class:"form-container",onSubmit:t[15]||(t[15]=Object(n["withModifiers"])((...e)=>a.goToCreateTest&&a.goToCreateTest(...e),["prevent"]))},[t[27]||(t[27]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("strong",null,"Test Name:")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=e=>l.testOptions.testName=e),placeholder:"Enter a name for this test",required:""},null,512),[[n["vModelText"],l.testOptions.testName]]),Object(n["createElementVNode"])("label",Nl,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"checkbox","onUpdate:modelValue":t[9]||(t[9]=e=>l.testOptions.coverPage=e)},null,512),[[n["vModelCheckbox"],l.testOptions.coverPage]]),t[25]||(t[25]=Object(n["createTextVNode"])(" Add a cover page "))]),t[28]||(t[28]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("strong",null,"Select Template:")],-1)),Object(n["createElementVNode"])("div",gl,[Object(n["createElementVNode"])("button",{type:"button",class:Object(n["normalizeClass"])({active:"All Questions"===l.testOptions.selectedTemplate}),onClick:t[10]||(t[10]=e=>l.testOptions.selectedTemplate="All Questions")}," All Questions ",2),Object(n["createElementVNode"])("button",{type:"button",class:Object(n["normalizeClass"])({active:"Multiple Choice"===l.testOptions.selectedTemplate}),onClick:t[11]||(t[11]=e=>l.testOptions.selectedTemplate="Multiple Choice")}," Multiple Choice ",2),Object(n["createElementVNode"])("button",{type:"button",class:Object(n["normalizeClass"])({active:"Short Answer/Essay"===l.testOptions.selectedTemplate}),onClick:t[12]||(t[12]=e=>l.testOptions.selectedTemplate="Short Answer/Essay")}," Short Answer/Essay ",2)]),t[29]||(t[29]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("strong",null,"Embedded Graphic:")],-1)),Object(n["createElementVNode"])("input",{type:"file",accept:"image/*",onChange:t[13]||(t[13]=(...e)=>a.handleGraphicUpload&&a.handleGraphicUpload(...e))},null,32),l.testOptions.graphicPreview?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",El,[t[26]||(t[26]=Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("strong",null,"Preview:")],-1)),Object(n["createElementVNode"])("img",{src:l.testOptions.graphicPreview,alt:"Uploaded Graphic Preview",style:{"max-width":"100%","max-height":"200px",border:"1px solid #ccc"}},null,8,Vl)])):Object(n["createCommentVNode"])("",!0),t[30]||(t[30]=Object(n["createElementVNode"])("button",{type:"submit",class:"btn"},"Yes, Continue",-1)),Object(n["createElementVNode"])("button",{type:"button",class:"btn cancel",onClick:t[14]||(t[14]=e=>l.showCreateTestWarning=!1)},"Cancel")],32)])])):Object(n["createCommentVNode"])("",!0),(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.selectedQuestions,(e,o)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:e.id,class:Object(n["normalizeClass"])(["question-box",{selected:l.selectedQuestionId===e.id}]),onClick:t=>a.toggleQuestionSelection(e.id)},[Object(n["createElementVNode"])("strong",null,"Question "+Object(n["toDisplayString"])(o+1)+":",1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.question_text),1),t[45]||(t[45]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[31]||(t[31]=Object(n["createElementVNode"])("strong",null,"Type:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.type),1)]),t[46]||(t[46]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[32]||(t[32]=Object(n["createElementVNode"])("strong",null,"Chapter:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.chapter_number||"N/A"),1)]),t[47]||(t[47]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[33]||(t[33]=Object(n["createElementVNode"])("strong",null,"Section:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.section_number||"N/A"),1)]),t[48]||(t[48]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[34]||(t[34]=Object(n["createElementVNode"])("strong",null,"Points:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.default_points),1)]),t[49]||(t[49]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[35]||(t[35]=Object(n["createElementVNode"])("strong",null,"Estimated Time:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.est_time)+" minutes",1)]),t[50]||(t[50]=Object(n["createElementVNode"])("br",null,null,-1)),"True/False"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",wl,[t[36]||(t[36]=Object(n["createElementVNode"])("strong",null,"Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.true_false_answer?"True":"False"),1)])):Object(n["createCommentVNode"])("",!0),"Multiple Choice"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",fl,[t[37]||(t[37]=Object(n["createElementVNode"])("strong",null,"Correct Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.correct_option&&e.correct_option.option_text||"Not specified"),1),t[38]||(t[38]=Object(n["createElementVNode"])("br",null,null,-1)),t[39]||(t[39]=Object(n["createElementVNode"])("strong",null,"Other Options:",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.incorrect_options||[],(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.option_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Matching"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Tl,[t[40]||(t[40]=Object(n["createElementVNode"])("strong",null,"Pairs:",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.matches||[],(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.prompt_text)+" - "+Object(n["toDisplayString"])(e.match_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Fill in the Blank"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",vl,[t[41]||(t[41]=Object(n["createElementVNode"])("strong",null,"Correct Answer(s):",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.blanks||[],(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.correct_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Short Answer"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Bl,[t[42]||(t[42]=Object(n["createElementVNode"])("strong",null,"Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.answer||"Not provided"),1)])):Object(n["createCommentVNode"])("",!0),"Essay"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",_l,[t[43]||(t[43]=Object(n["createElementVNode"])("strong",null,"Essay Instructions:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.grading_instructions||"None"),1)])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("span",null,[t[44]||(t[44]=Object(n["createElementVNode"])("strong",null,"Grading Instructions:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.grading_instructions||"None"),1)]),l.selectedQuestionId===e.id?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",xl,[Object(n["createElementVNode"])("button",{onClick:Object(n["withModifiers"])(t=>a.removeQuestionFromTestBank(e.id),["stop"])},"Remove",8,Cl)])):Object(n["createCommentVNode"])("",!0),t[51]||(t[51]=Object(n["createElementVNode"])("hr",null,null,-1))],10,yl))),128))])])}var Fl={name:"TeacherViewTB",data(){return{showPopup:!1,showEditForm:!1,showEditQuestionForm:!1,showCreateTestWarning:!1,testFiles:[],selectedQuestions:[],selectedQuestionId:null,editingQuestionData:{},editingQuestionId:null,courseId:this.$route.query.courseId||"",courseTitle:this.$route.query.courseTitle||"",testBankId:this.$route.params.id||"",testBankName:this.$route.query.testBankName||"",editForm:{name:this.$route.query.testBankName||"",chapter:"",section:""},testOptions:{testName:"",coverPage:!1,selectedTemplate:"",graphicFile:null,graphicFileName:"",graphicPreview:""}}},mounted(){this.initialize()},methods:{async viewPrevious(){try{const e=await F.get("/tests",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{course_id:this.courseId,testbank_id:this.testBankId}});this.testFiles=e.data.tests||[],this.showPopup=!0}catch(e){console.error("Failed to fetch tests:",e),alert("Could not load previous tests.")}},closeForm(){this.showPopup=!1},async fetchQuestions(){if(this.testBankId)try{const e=await F.get(`/testbanks/${this.testBankId}/questions`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log("Fetched questions:",e.data.questions),this.selectedQuestions=e.data.questions||[]}catch(e){console.error("Error fetching questions for test bank:",e),this.selectedQuestions=[]}},toggleQuestionSelection(e){this.selectedQuestionId=this.selectedQuestionId===e?null:e},async removeQuestionFromTestBank(e){if(confirm("Are you sure you want to remove this question from the test bank?"))try{await F.delete(`/testbanks/${this.testBankId}/questions/${e}`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),this.selectedQuestions=this.selectedQuestions.filter(t=>t.id!==e),alert("Question removed from test bank.")}catch(t){console.error("Error removing question:",t),alert("Failed to remove question from test bank.")}},async updateTestBank(){try{await F.put("/testbanks/teacher/"+this.testBankId,{name:this.editForm.name,chapter_number:this.editForm.chapter,section_number:this.editForm.section},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),this.testBankName=this.editForm.name,this.showEditForm=!1,alert("Test bank updated successfully.")}catch(e){console.error("Error updating test bank:",e),alert("Failed to update test bank.")}},async initialize(){await this.fetchQuestions();try{const e=await F.get("/testbanks/"+this.testBankId,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.testBankName=e.data.name,this.editForm.name=e.data.name,this.editForm.chapter=e.data.chapter_number,this.editForm.section=e.data.section_number}catch(e){console.warn("Couldn't load testbank details:",e)}},handleGraphicUpload(e){const t=e.target.files[0];if(!t)return;const o=new FileReader;o.onload=e=>{this.testOptions.graphicFile=t,this.testOptions.graphicFileName=t.name,this.testOptions.graphicPreview=e.target.result},o.readAsDataURL(t)},goToCreateTest(){const e={testName:this.testOptions.testName,selectedTemplate:this.testOptions.selectedTemplate,uploadedImage:this.testOptions.graphicFileName||"",coverPage:this.testOptions.coverPage||!1,graphicPreview:this.testOptions.graphicPreview||""};localStorage.setItem("testOptions",JSON.stringify(e)),this.$router.push({path:"/TeacherTemplate",query:{courseId:this.courseId,courseTitle:this.courseTitle,testBankId:this.testBankId,testBankName:this.testBankName}})}}};o("563b");const Dl=s()(Fl,[["render",Sl],["__scopeId","data-v-bb6766c8"]]);var Il=Dl;const ql={class:"theme-webmaster"},Al={class:"top-banner"},Ml={class:"banner-actions"},Ql={class:"center large-paragraph",style:{color:"#222"}};function Pl(e,t,o,c,l,a){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",ql,[Object(n["createElementVNode"])("div",Al,[t[6]||(t[6]=Object(n["createElementVNode"])("div",{class:"banner-title"},"Database Downloads",-1)),Object(n["createElementVNode"])("div",Ml,[Object(n["createVNode"])(r,{to:"/",class:"banner-btn"},{default:Object(n["withCtx"])(()=>t[5]||(t[5]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",Ql,[t[7]||(t[7]=Object(n["createElementVNode"])("p",null,"Select a dataset to download:",-1)),t[8]||(t[8]=Object(n["createElementVNode"])("p",null,"Note: Download All will download each file separately for readability.",-1)),Object(n["createElementVNode"])("button",{class:"button",onClick:t[0]||(t[0]=e=>a.downloadData("users"))},"Download Users"),Object(n["createElementVNode"])("button",{class:"button",onClick:t[1]||(t[1]=e=>a.downloadData("textbook"))},"Download Textbooks"),Object(n["createElementVNode"])("button",{class:"button",onClick:t[2]||(t[2]=e=>a.downloadData("courses"))},"Download Courses"),Object(n["createElementVNode"])("button",{class:"button",onClick:t[3]||(t[3]=e=>a.downloadData("questions"))},"Download Questions"),Object(n["createElementVNode"])("button",{class:"button",onClick:t[4]||(t[4]=e=>a.downloadData("all"))},"Download All")])])}var Ul={name:"WebmasterHome",methods:{async downloadData(e){const t={users:"users",courses:"courses",textbook:"textbook",questions:"questions"};if("all"===e){for(const[e,o]of Object.entries(t))await this.fetchAndDownload(o,e+".csv");return}const o=t[e];o?await this.fetchAndDownload(o,e+".csv"):alert("Unsupported download type: "+e)},async fetchAndDownload(e,t){try{const o=await F.get("/download/"+e,{responseType:"blob"}),n=window.URL.createObjectURL(o.data),c=document.createElement("a");c.href=n,c.download=t,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(n)}catch(o){console.error(`Download error for ${e}:`,o),alert("Failed to download "+t)}}}};o("1409");const Ll=s()(Ul,[["render",Pl],["__scopeId","data-v-9bd85086"]]);var $l=Ll;const zl={class:"theme-webmaster"},Hl={class:"center large-paragraph",style:{color:"#222"}},Rl=["disabled"],Wl={key:0,class:"error-message"},Gl={key:1,class:"loading-message"};function Jl(e,t,o,c,l,a){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",zl,[t[14]||(t[14]=Object(n["createElementVNode"])("div",{class:"top-banner"},[Object(n["createElementVNode"])("div",{class:"banner-title"},"Webmaster Login")],-1)),Object(n["createElementVNode"])("div",Hl,[t[11]||(t[11]=Object(n["createTextVNode"])(" Please enter your webmaster username and password: ")),t[12]||(t[12]=Object(n["createElementVNode"])("br",null,null,-1)),t[13]||(t[13]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("form",{onSubmit:t[2]||(t[2]=Object(n["withModifiers"])((...e)=>a.submitForm&&a.submitForm(...e),["prevent"]))},[t[3]||(t[3]=Object(n["createElementVNode"])("label",{for:"uname"},"Username:",-1)),t[4]||(t[4]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"uname","onUpdate:modelValue":t[0]||(t[0]=e=>l.username=e)},null,512),[[n["vModelText"],l.username]]),t[5]||(t[5]=Object(n["createElementVNode"])("br",null,null,-1)),t[6]||(t[6]=Object(n["createElementVNode"])("br",null,null,-1)),t[7]||(t[7]=Object(n["createElementVNode"])("label",{for:"pass"},"Password:",-1)),t[8]||(t[8]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"password",id:"pass","onUpdate:modelValue":t[1]||(t[1]=e=>l.password=e)},null,512),[[n["vModelText"],l.password]]),t[9]||(t[9]=Object(n["createElementVNode"])("br",null,null,-1)),t[10]||(t[10]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("input",{type:"submit",value:"Submit",disabled:l.loading},null,8,Rl)],32),l.errorMessage?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Wl,Object(n["toDisplayString"])(l.errorMessage),1)):Object(n["createCommentVNode"])("",!0),l.loading?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Gl,"Logging in...")):Object(n["createCommentVNode"])("",!0)])])}var Xl={data(){return{username:"",password:"",errorMessage:"",loading:!1}},mounted(){const e=localStorage.getItem("token");if(e)try{const t=Object(D["default"])(e),o=Date.now()/1e3;t.exp>o&&"webmaster"===t.role&&this.$router.push("/WebmasterHome")}catch(t){console.error("Invalid token",t)}},methods:{async submitForm(){if(this.username&&this.password)if(this.username.trim().length<3||this.password.trim().length<6)this.errorMessage="Username must be at least 3 characters and password at least 6 characters.";else{this.loading=!0,this.errorMessage="";try{const e=await F.post("/auth/login",{username:this.username.toLowerCase(),password:this.password}),{token:t,user_id:o,role:n}=e.data;localStorage.setItem("token",t),localStorage.setItem("user_id",o),localStorage.setItem("role",n),"webmaster"===n?this.$router.push("/WebmasterHome"):(this.errorMessage="Only webmasters can log in here.",localStorage.clear())}catch(e){e.response?401===e.response.status?this.errorMessage="Invalid username or password.":this.errorMessage=e.response&&e.response.data&&e.response.data.message||"An error occurred during login.":this.errorMessage="Network error. Please check your connection."}finally{this.loading=!1}}else this.errorMessage="Please enter both username and password."}}};o("d941");const Kl=s()(Xl,[["render",Jl],["__scopeId","data-v-2950ba08"]]);var Yl=Kl;const Zl=[{path:"/",name:"Welcome",component:N},{path:"/PubHome",name:"PubHome",component:A},{path:"/PubLog",name:"PubLog",component:R},{path:"/PubNewBook",name:"PubNewBook",component:ee},{path:"/PubNewTB",name:"PubNewTB",component:ie},{path:"/PubQuestions",name:"PubQuestions",component:ot},{path:"/PubViewFeedback",name:"PubViewFeedback",component:jt},{path:"/PubViewTB",name:"PubViewTB",component:Lt},{path:"/TeacherHome",name:"TeacherHome",component:oo},{path:"/TeacherLog",name:"TeacherLog",component:uo},{path:"/TeacherNewClass",name:"TeacherNewClass",component:Vo},{path:"/TeacherNewTB",name:"TeacherNewTB",component:xo},{path:"/TeacherNewTest",name:"TeacherNewTest",component:zo},{path:"/TeacherPubQ",name:"TeacherPubQ",component:Bn},{path:"/TeacherQuestions",name:"TeacherQuestions",component:yc},{path:"/TeacherTemplate",name:"TeacherTemplate",component:il},{path:"/TeacherViewTB/:id",name:"TeacherViewTB",component:Il},{path:"/WebmasterHome",name:"WebmasterHome",component:$l},{path:"/WebmasterLog",name:"WebmasterLog",component:Yl}],ea=Object(b["a"])({history:Object(b["b"])(),routes:Zl});var ta=ea;const oa=Object(n["createApp"])(d);oa.use(ta),oa.mount("#app")},"5c71":function(e,t,o){"use strict";o("d1fa")},"5d90":function(e,t,o){"use strict";o("8dcc")},"65d8":function(e,t,o){},"6a83":function(e,t,o){"use strict";o("0c21")},"7b78":function(e,t,o){},"7c9b":function(e,t,o){},"8bca":function(e,t,o){"use strict";o("4ff5")},"8d9a":function(e,t,o){"use strict";o("284b")},"8dcc":function(e,t,o){},"8ec4":function(e,t,o){},"93bd":function(e,t,o){},a65d:function(e,t,o){},b458:function(e,t,o){},b4e7:function(e,t,o){"use strict";o("bcca")},b7ca:function(e,t,o){"use strict";o("e6dc")},bcca:function(e,t,o){},c2c6:function(e,t,o){},c4f7:function(e,t,o){"use strict";o("b458")},d1fa:function(e,t,o){},d23e:function(e,t,o){"use strict";o("7c9b")},d941:function(e,t,o){"use strict";o("e54d")},e004:function(e,t,o){"use strict";o("93bd")},e54d:function(e,t,o){},e6dc:function(e,t,o){},eba8:function(e,t,o){"use strict";o("a65d")}});
//# sourceMappingURL=app.3f0ea8d0.js.map